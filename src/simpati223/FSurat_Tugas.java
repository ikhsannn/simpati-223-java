/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */

package simpati223;

import com.itextpdf.text.Document;
import com.itextpdf.text.Element;
import com.itextpdf.text.Font;
import com.itextpdf.text.Image;
import com.itextpdf.text.PageSize;
import com.itextpdf.text.Paragraph;
import com.itextpdf.text.Phrase;
import com.itextpdf.text.Rectangle;
import com.itextpdf.text.pdf.PdfPCell;
import com.itextpdf.text.pdf.PdfPTable;
import com.itextpdf.text.pdf.PdfWriter;
import java.awt.Desktop;
import java.awt.event.ItemEvent;
import java.awt.event.ItemListener;
import java.awt.event.KeyEvent;
import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.SQLException;
import java.text.SimpleDateFormat;
import javax.swing.JOptionPane;
import javax.swing.table.DefaultTableModel;
import javax.swing.table.TableColumn;

/**
 *
 * @author Ikhsan Abdillah
 */
public class FSurat_Tugas extends javax.swing.JInternalFrame {

    private DefaultTableModel DftTblModel_Surat_Tugas;
    private String SQL;
    public String dateChooser, menugaskan_kepada, nikki, jabatan;
    
    /** Creates new form FSurat_Tugas1 */
    public FSurat_Tugas() {
        initComponents();
        TampilData();
        disableData();
        Combox1("");
        jComboBox1.addItemListener(new ItemListener() {
            public void itemStateChanged(ItemEvent e) {
                if (e.getStateChange() == ItemEvent.SELECTED) {
                    try {
                        Connection conn = Koneksi.getConnection();
                        Object selectedItem = jComboBox1.getSelectedItem();
                        if (selectedItem != null) {
                            java.sql.Statement stmt = conn.createStatement();
                            SQL = "select * from guru where nama = '"+selectedItem+"'";
                            java.sql.ResultSet res = stmt.executeQuery(SQL);

                            while (res.next()) {
                                menugaskan_kepada = res.getString("id");
                            }
                        }
                    } catch (SQLException es) {
                        JOptionPane.showMessageDialog(null, "Ada kesalahan server, silahkan hubungi developer", "Pesan", JOptionPane.INFORMATION_MESSAGE);
                    }
                }
            }
        });
    }
    
    private void setTanggal(){
        Connection conn = Koneksi.getConnection();
        try {
            java.sql.Statement stmt = conn.createStatement();
            SQL = "select * from surat_tugas where id like '%" +jTextField2.getText()+"'";
            java.sql.ResultSet res = stmt.executeQuery(SQL);
            while (res.next())
            {
                jDateChooser1.setDate(res.getDate("tgl_surat", null));
            }
        }catch (Exception e){
            JOptionPane.showMessageDialog(null, "Ada kesalahan server, silahkan hubungi developer", "Pesan", JOptionPane.INFORMATION_MESSAGE);
        }
    }
    
    private void Combox1(String id_guru){
        Connection conn = Koneksi.getConnection();
        if (id_guru.isEmpty()) {
            try {
                 java.sql.Statement stmt = conn.createStatement();
                SQL = "select * from guru";
                java.sql.ResultSet res = stmt.executeQuery(SQL);

                while (res.next()) {                
                    jComboBox1.addItem(res.getString("nama"));
                }

                res.last();
                int jumlahdata = res.getRow();
                res.first();

            } catch (SQLException e) {
                JOptionPane.showMessageDialog(null, "Ada kesalahan server, silahkan hubungi developer", "Pesan", JOptionPane.INFORMATION_MESSAGE);
            }  
        } else {
            try {
                java.sql.Statement stmt = conn.createStatement();
                SQL = "select * from guru where nama = '"+id_guru+"'";
                java.sql.ResultSet res = stmt.executeQuery(SQL);

                while (res.next()) {
                    menugaskan_kepada = res.getString("id");
                    nikki = res.getString("nip");
                    jabatan = res.getString("jabatan");
                }
            } catch (SQLException es) {
                JOptionPane.showMessageDialog(null, "Ada kesalahan server, silahkan hubungi developer", "Pesan", JOptionPane.INFORMATION_MESSAGE);
            }
        }
    }

    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jPanel1 = new javax.swing.JPanel();
        jLabel1 = new javax.swing.JLabel();
        jTextField2 = new javax.swing.JTextField();
        jPanel2 = new javax.swing.JPanel();
        jLabel8 = new javax.swing.JLabel();
        jTextField3 = new javax.swing.JTextField();
        jLabel9 = new javax.swing.JLabel();
        jTextField4 = new javax.swing.JTextField();
        jLabel10 = new javax.swing.JLabel();
        jLabel12 = new javax.swing.JLabel();
        jDateChooser1 = new com.toedter.calendar.JDateChooser();
        jScrollPane2 = new javax.swing.JScrollPane();
        jTextArea1 = new javax.swing.JTextArea();
        jLabel2 = new javax.swing.JLabel();
        jLabel11 = new javax.swing.JLabel();
        jTextField6 = new javax.swing.JTextField();
        jLabel13 = new javax.swing.JLabel();
        jTextField7 = new javax.swing.JTextField();
        jLabel3 = new javax.swing.JLabel();
        jScrollPane3 = new javax.swing.JScrollPane();
        jTextArea2 = new javax.swing.JTextArea();
        jComboBox1 = new javax.swing.JComboBox<>();
        jLabel4 = new javax.swing.JLabel();
        jButton6 = new javax.swing.JButton();
        jPanel3 = new javax.swing.JPanel();
        jButton2 = new javax.swing.JButton();
        jButton3 = new javax.swing.JButton();
        jButton4 = new javax.swing.JButton();
        jButton5 = new javax.swing.JButton();
        jButton1 = new javax.swing.JButton();
        jPanel7 = new javax.swing.JPanel();
        jScrollPane1 = new javax.swing.JScrollPane();
        jTable1 = new javax.swing.JTable();

        jPanel1.setBackground(new java.awt.Color(255, 255, 255));

        jLabel1.setFont(new java.awt.Font("Tahoma", 1, 18)); // NOI18N
        jLabel1.setText("Surat Tugas");

        jTextField2.setPreferredSize(new java.awt.Dimension(60, 20));

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jTextField2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(jLabel1)
                .addGap(40, 40, 40))
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addGap(10, 10, 10)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addComponent(jTextField2, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addGap(2, 2, 2))
                    .addComponent(jLabel1, javax.swing.GroupLayout.Alignment.LEADING))
                .addGap(13, 13, 13))
        );

        jPanel2.setBackground(new java.awt.Color(255, 255, 255));
        jPanel2.setToolTipText("");
        jPanel2.setName(""); // NOI18N

        jLabel8.setText("No Surat");
        jLabel8.setPreferredSize(new java.awt.Dimension(80, 14));

        jTextField3.setPreferredSize(new java.awt.Dimension(145, 25));

        jLabel9.setText("Tentang Surat");
        jLabel9.setPreferredSize(new java.awt.Dimension(80, 14));

        jTextField4.setPreferredSize(new java.awt.Dimension(145, 25));

        jLabel10.setText("Menugaskan Kpd");
        jLabel10.setPreferredSize(new java.awt.Dimension(140, 14));

        jLabel12.setText("Tgl Surat");
        jLabel12.setPreferredSize(new java.awt.Dimension(80, 14));

        jDateChooser1.setPreferredSize(new java.awt.Dimension(145, 25));
        jDateChooser1.addPropertyChangeListener(new java.beans.PropertyChangeListener() {
            public void propertyChange(java.beans.PropertyChangeEvent evt) {
                jDateChooser1PropertyChange(evt);
            }
        });

        jScrollPane2.setPreferredSize(new java.awt.Dimension(145, 60));

        jTextArea1.setColumns(20);
        jTextArea1.setRows(5);
        jTextArea1.setPreferredSize(new java.awt.Dimension(145, 60));
        jScrollPane2.setViewportView(jTextArea1);

        jLabel2.setText("Ket 1");
        jLabel2.setPreferredSize(new java.awt.Dimension(70, 14));

        jLabel11.setText("Tempat Tugas");
        jLabel11.setPreferredSize(new java.awt.Dimension(130, 14));

        jTextField6.setPreferredSize(new java.awt.Dimension(145, 25));

        jLabel13.setText("Waktu Tugas");
        jLabel13.setPreferredSize(new java.awt.Dimension(130, 14));

        jTextField7.setPreferredSize(new java.awt.Dimension(145, 25));

        jLabel3.setText("Ket 2");
        jLabel3.setPreferredSize(new java.awt.Dimension(70, 14));

        jScrollPane3.setPreferredSize(new java.awt.Dimension(145, 60));

        jTextArea2.setColumns(20);
        jTextArea2.setRows(5);
        jTextArea2.setPreferredSize(new java.awt.Dimension(145, 30));
        jScrollPane3.setViewportView(jTextArea2);

        jComboBox1.setPreferredSize(new java.awt.Dimension(145, 25));

        jLabel4.setText("File");
        jLabel4.setPreferredSize(new java.awt.Dimension(60, 14));

        jButton6.setText("Cetak");
        jButton6.setPreferredSize(new java.awt.Dimension(145, 25));
        jButton6.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton6ActionPerformed(evt);
            }
        });
        jButton6.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jButton6KeyPressed(evt);
            }
        });

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addGap(10, 10, 10)
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel12, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel9, javax.swing.GroupLayout.PREFERRED_SIZE, 82, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel8, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addContainerGap()
                        .addComponent(jLabel10, javax.swing.GroupLayout.PREFERRED_SIZE, 107, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jTextField3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jTextField4, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jDateChooser1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(11, 11, 11)
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel11, javax.swing.GroupLayout.PREFERRED_SIZE, 107, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel13, javax.swing.GroupLayout.PREFERRED_SIZE, 107, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(4, 4, 4)
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel2Layout.createSequentialGroup()
                                .addComponent(jScrollPane2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(jLabel4, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addComponent(jTextField7, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addGroup(jPanel2Layout.createSequentialGroup()
                                .addComponent(jTextField6, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(11, 11, 11)
                                .addComponent(jLabel3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))))
                    .addComponent(jComboBox1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(4, 4, 4)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jScrollPane3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jButton6, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(38, 38, 38))
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addGap(20, 20, 20)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel8, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jTextField3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel11, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jTextField6, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(10, 10, 10)
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel2Layout.createSequentialGroup()
                                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(jLabel12, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(jDateChooser1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addGap(10, 10, 10)
                                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                    .addComponent(jLabel9, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(jTextField4, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(jLabel2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addGap(10, 10, 10)
                                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                    .addComponent(jComboBox1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(jLabel10, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                            .addComponent(jLabel13, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addGroup(jPanel2Layout.createSequentialGroup()
                                .addComponent(jTextField7, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(jScrollPane2, javax.swing.GroupLayout.PREFERRED_SIZE, 85, javax.swing.GroupLayout.PREFERRED_SIZE))))
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addComponent(jScrollPane3, javax.swing.GroupLayout.PREFERRED_SIZE, 92, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(10, 10, 10)
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jButton6, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel4, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))))
                .addGap(20, 20, 20))
        );

        jPanel3.setBackground(new java.awt.Color(255, 255, 255));
        jPanel3.setForeground(new java.awt.Color(255, 255, 255));

        jButton2.setBackground(new java.awt.Color(51, 0, 204));
        jButton2.setFont(new java.awt.Font("Tahoma", 1, 20)); // NOI18N
        jButton2.setForeground(new java.awt.Color(255, 255, 255));
        jButton2.setText("Simpan");
        jButton2.setPreferredSize(new java.awt.Dimension(120, 33));
        jButton2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton2ActionPerformed(evt);
            }
        });
        jButton2.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jButton2KeyPressed(evt);
            }
        });

        jButton3.setBackground(new java.awt.Color(255, 204, 0));
        jButton3.setFont(new java.awt.Font("Tahoma", 1, 20)); // NOI18N
        jButton3.setForeground(new java.awt.Color(255, 255, 255));
        jButton3.setText("Ubah");
        jButton3.setPreferredSize(new java.awt.Dimension(120, 33));
        jButton3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton3ActionPerformed(evt);
            }
        });
        jButton3.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jButton3KeyPressed(evt);
            }
        });

        jButton4.setBackground(new java.awt.Color(204, 0, 0));
        jButton4.setFont(new java.awt.Font("Tahoma", 1, 20)); // NOI18N
        jButton4.setForeground(new java.awt.Color(255, 255, 255));
        jButton4.setText("Hapus");
        jButton4.setPreferredSize(new java.awt.Dimension(120, 33));
        jButton4.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton4ActionPerformed(evt);
            }
        });
        jButton4.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jButton4KeyPressed(evt);
            }
        });

        jButton5.setBackground(new java.awt.Color(0, 153, 0));
        jButton5.setFont(new java.awt.Font("Tahoma", 1, 20)); // NOI18N
        jButton5.setForeground(new java.awt.Color(255, 255, 255));
        jButton5.setText("Batal");
        jButton5.setPreferredSize(new java.awt.Dimension(120, 33));
        jButton5.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton5ActionPerformed(evt);
            }
        });
        jButton5.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jButton5KeyPressed(evt);
            }
        });

        jButton1.setBackground(new java.awt.Color(0, 153, 153));
        jButton1.setFont(new java.awt.Font("Tahoma", 1, 18)); // NOI18N
        jButton1.setForeground(new java.awt.Color(255, 255, 255));
        jButton1.setText("New");
        jButton1.setMaximumSize(new java.awt.Dimension(109, 31));
        jButton1.setPreferredSize(new java.awt.Dimension(100, 33));
        jButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton1ActionPerformed(evt);
            }
        });
        jButton1.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jButton1KeyPressed(evt);
            }
        });

        javax.swing.GroupLayout jPanel3Layout = new javax.swing.GroupLayout(jPanel3);
        jPanel3.setLayout(jPanel3Layout);
        jPanel3Layout.setHorizontalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addGap(85, 85, 85)
                .addComponent(jButton1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jButton2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jButton3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jButton4, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jButton5, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );
        jPanel3Layout.setVerticalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addGap(10, 10, 10)
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jButton2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jButton3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jButton4, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jButton5, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jButton1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(10, 10, 10))
        );

        jPanel7.setBackground(new java.awt.Color(255, 255, 255));

        jTable1.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "No Surat", "Tanggal Surat", "Yang bertanda tangan", "Menerangkan kepada"
            }
        ));
        jTable1.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jTable1MouseClicked(evt);
            }
        });
        jScrollPane1.setViewportView(jTable1);

        javax.swing.GroupLayout jPanel7Layout = new javax.swing.GroupLayout(jPanel7);
        jPanel7.setLayout(jPanel7Layout);
        jPanel7Layout.setHorizontalGroup(
            jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel7Layout.createSequentialGroup()
                .addGap(15, 15, 15)
                .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 754, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(10, 10, 10))
        );
        jPanel7Layout.setVerticalGroup(
            jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel7Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jScrollPane1, javax.swing.GroupLayout.DEFAULT_SIZE, 217, Short.MAX_VALUE)
                .addGap(10, 10, 10))
        );

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
            .addComponent(jPanel2, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
            .addComponent(jPanel3, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
            .addComponent(jPanel7, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(14, 14, 14)
                .addComponent(jPanel2, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGap(10, 10, 10)
                .addComponent(jPanel3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(10, 10, 10)
                .addComponent(jPanel7, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(7, 7, 7))
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    public static void hideJTableColumn(TableColumn tc) {
       lockJTableColumnWidth(tc, 0);
   }

   public static void lockJTableColumnWidth(TableColumn tc, int pixels) {
       if (tc != null) {
           tc.setMinWidth(pixels);
           tc.setMaxWidth(pixels);
           tc.setPreferredWidth(pixels);
           tc.setResizable(false);
       }
   }
   
    private void jButton2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton2ActionPerformed
        // TODO add your handling code here:
        simpanData();
    }//GEN-LAST:event_jButton2ActionPerformed

    private void jButton2KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jButton2KeyPressed
        // TODO add your handling code here:
        if(evt.getKeyCode() == java.awt.event.KeyEvent.VK_ENTER){
            simpanData();
        }
    }//GEN-LAST:event_jButton2KeyPressed

    private void jButton3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton3ActionPerformed
        // TODO add your handling code here:
        String id = jTextField2.getText();
        if (id.isEmpty()) {
            JOptionPane.showMessageDialog(null, "Silahkan pilih data terlebih dahulu atau klik tombol new", "Pesan", JOptionPane.INFORMATION_MESSAGE);
        } else {
            editData();
        }
    }//GEN-LAST:event_jButton3ActionPerformed

    private void jButton3KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jButton3KeyPressed
        // TODO add your handling code here:
        if(evt.getKeyCode() == java.awt.event.KeyEvent.VK_ENTER){
            String id = jTextField2.getText();
            if (id.isEmpty()) {
                JOptionPane.showMessageDialog(null, "Silahkan pilih data terlebih dahulu atau klik tombol new", "Pesan", JOptionPane.INFORMATION_MESSAGE);
            } else {
                editData();
            }
        }
    }//GEN-LAST:event_jButton3KeyPressed

    private void jButton4ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton4ActionPerformed
        // TODO add your handling code here:
        String id = jTextField2.getText();
        if (id.isEmpty()) {
            JOptionPane.showMessageDialog(null, "Silahkan pilih data terlebih dahulu atau klik tombol new", "Pesan", JOptionPane.INFORMATION_MESSAGE);
        } else {
            deleteData();
        }
    }//GEN-LAST:event_jButton4ActionPerformed

    private void jButton4KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jButton4KeyPressed
        // TODO add your handling code here:
        if(evt.getKeyCode() == java.awt.event.KeyEvent.VK_ENTER){
            String id = jTextField2.getText();
            if (id.isEmpty()) {
                JOptionPane.showMessageDialog(null, "Silahkan pilih data terlebih dahulu atau klik tombol new", "Pesan", JOptionPane.INFORMATION_MESSAGE);
            } else {
                deleteData();
            }
        }
    }//GEN-LAST:event_jButton4KeyPressed

    private void jButton5ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton5ActionPerformed
        // TODO add your handling code here:
        dispose();
    }//GEN-LAST:event_jButton5ActionPerformed

    private void jButton5KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jButton5KeyPressed
        // TODO add your handling code here:
        if(evt.getKeyCode()==KeyEvent.VK_ENTER){
            dispose();
        }
    }//GEN-LAST:event_jButton5KeyPressed

    private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton1ActionPerformed
        // TODO add your handling code here:
        enableData();
        clearData();
    }//GEN-LAST:event_jButton1ActionPerformed

    private void jButton1KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jButton1KeyPressed
        // TODO add your handling code here:
        if(evt.getKeyCode()==KeyEvent.VK_ENTER){
            enableData();
            clearData();
        }
    }//GEN-LAST:event_jButton1KeyPressed

    private void jTable1MouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jTable1MouseClicked
        // TODO add your handling code here:
        getData();
        enableDataEdit();
    }//GEN-LAST:event_jTable1MouseClicked

    public void TampilData() {
        DftTblModel_Surat_Tugas = new DefaultTableModel();
        DftTblModel_Surat_Tugas.addColumn("id");
        DftTblModel_Surat_Tugas.addColumn("Nomor Surat");
        DftTblModel_Surat_Tugas.addColumn("Tanggal Surat");
        DftTblModel_Surat_Tugas.addColumn("Tentang Surat");
        DftTblModel_Surat_Tugas.addColumn("Menugaskan Kepada");
        DftTblModel_Surat_Tugas.addColumn("Tempat Tugas");
        DftTblModel_Surat_Tugas.addColumn("Waktu Tugas"); 
        DftTblModel_Surat_Tugas.addColumn("Keterangan");
        DftTblModel_Surat_Tugas.addColumn("Keterangan 2");
       jTable1.setModel(DftTblModel_Surat_Tugas);

        Connection conn = Koneksi.getConnection();
        try {
            java.sql.Statement stmt = conn.createStatement();
            SQL = "select a.*,b.nama as nama_guru from surat_tugas a "+
                   "LEFT JOIN guru b ON a.id_guru = b.id";
            java.sql.ResultSet res = stmt.executeQuery(SQL);
            while (res.next()) {
               DftTblModel_Surat_Tugas.addRow(new Object[]{
                    res.getString("id"),
                    res.getString("nomor_surat"), //tampilin ke layar
                    res.getString("tgl_surat"), //tampilin ke layar
                    res.getString("tentang_surat"), //tampilin ke layar
                    res.getString("nama_guru"),//tampilin ke layar
                    res.getString("tempat_tugas"),
                    res.getString("waktu_tugas"),
                    res.getString("keterangan"),
                    res.getString("keterangan2"),
                });
            }
            hideJTableColumn(jTable1.getColumnModel().getColumn(0));
            hideJTableColumn(jTable1.getColumnModel().getColumn(5));
            hideJTableColumn(jTable1.getColumnModel().getColumn(6));
            hideJTableColumn(jTable1.getColumnModel().getColumn(7));
            hideJTableColumn(jTable1.getColumnModel().getColumn(8));
            TableColumn column = jTable1.getColumnModel().getColumn(2);
            column.setPreferredWidth(8);
        } catch (SQLException e) {
            System.out.println(e.getMessage());
        }
    }
//    
    public void disableData(){
        jTextField2.setVisible(false);
        jButton2.setEnabled(false);
        jButton3.setEnabled(false);
        jButton4.setEnabled(false);
        jButton6.setEnabled(false);
        //atur dibawahnya
        jTextField3.setEnabled(false);
        jDateChooser1.setEnabled(false);
        jTextField4.setEnabled(false);
        jComboBox1.setEnabled(false);
        jTextField6.setEnabled(false);
        jTextField7.setEnabled(false);
        jTextArea1.setEnabled(false);
        jTextArea2.setEnabled(false);
    }
////    
    public void enableData(){
        jButton1.setEnabled(true);
        jButton2.setEnabled(true);
        jButton3.setEnabled(false);
        jButton4.setEnabled(false);
        jButton5.setEnabled(true);
        jButton6.setEnabled(false);
        //atur dibawahnya
        jTextField3.setEnabled(true);
        jDateChooser1.setEnabled(true);
        jTextField4.setEnabled(true);
        jComboBox1.setEnabled(true);
        jTextField6.setEnabled(true);
        jTextField7.setEnabled(true);
        jTextArea1.setEnabled(true);
        jTextArea2.setEnabled(true);
    }
//    
    public void enableDataEdit(){
        jButton1.setEnabled(true);
        jButton2.setEnabled(false);
        jButton3.setEnabled(true);
        jButton4.setEnabled(true);
        jButton5.setEnabled(true);
        jButton6.setEnabled(true);
        //atur dibawahnya
        jTextField3.setEnabled(true);
        jDateChooser1.setEnabled(true);
        jTextField4.setEnabled(true);
        jComboBox1.setEnabled(true);
        jTextField6.setEnabled(true);
        jTextField7.setEnabled(true);
        jTextArea1.setEnabled(true);
        jTextArea2.setEnabled(true);
    }
//    
    public void clearData(){
        jTextField2.setText("");
        jDateChooser1.setDate(null);
        jTextField2.setText("");
        jTextField3.setText("");
        jTextField4.setText("");
        jComboBox1.setSelectedItem(null);
        jTextField6.setText("");
        jTextField7.setText("");
        jTextArea1.setText("");
        jTextArea2.setText("");
    }
////    
    public void getData() {
        jTextField2.setText(jTable1.getValueAt(jTable1.getSelectedRow(), 0).toString());
        //atur dibawahnya 
        jTextField3.setText(jTable1.getValueAt(jTable1.getSelectedRow(), 1).toString());
        setTanggal();
        jTextField4.setText(jTable1.getValueAt(jTable1.getSelectedRow(), 3).toString());
        Object obj = jTable1.getValueAt(jTable1.getSelectedRow(), 4);
        jComboBox1.setSelectedItem(obj);
        Combox1((String) obj);
        jTextField6.setText(jTable1.getValueAt(jTable1.getSelectedRow(), 5).toString());
        jTextField7.setText(jTable1.getValueAt(jTable1.getSelectedRow(), 6).toString());
        jTextArea1.setText(jTable1.getValueAt(jTable1.getSelectedRow(), 7).toString());
        jTextArea2.setText(jTable1.getValueAt(jTable1.getSelectedRow(), 8).toString());
        jButton2.setEnabled(false);
    }
//
////    
  public void simpanData() {
    try {
        Connection conn = Koneksi.getConnection();
        PreparedStatement stmt = conn.prepareStatement("insert into surat_tugas(nomor_surat, tgl_surat, tentang_surat, id_guru, tempat_tugas, waktu_tugas, keterangan, keterangan2) "
                + "values(?,?,?,?,?,?,?,?)");
        stmt.setString(1, jTextField3.getText());
        stmt.setObject(2, jDateChooser1.getDate());
        stmt.setString(3, jTextField4.getText());
        stmt.setString(4, menugaskan_kepada);
        stmt.setString(5, jTextField6.getText());
        stmt.setString(6, jTextField7.getText()); 
        stmt.setString(7, jTextArea1.getText());
        stmt.setString(8, jTextArea2.getText());
        stmt.executeUpdate();
        JOptionPane.showMessageDialog(null, "Data berhasil disimpan", "Pesan", JOptionPane.INFORMATION_MESSAGE);
        TampilData();
        clearData();
    } catch (SQLException e) {
        JOptionPane.showMessageDialog(null, "Data gagal disimpan", "Pesan", 
                        JOptionPane.ERROR_MESSAGE);
    }
}
//
////    
    public void editData(){
        try {
            Connection conn = Koneksi.getConnection();
            Object id = jTable1.getValueAt(jTable1.getSelectedRow(), 0);
            PreparedStatement stmt = conn.prepareStatement("UPDATE surat_tugas SET nomor_surat='" + jTextField3.getText() + "',tgl_surat ='" +dateChooser+
                    "'," + "tentang_surat ='" +jTextField4.getText()+"',id_guru ='" +menugaskan_kepada+
                    "'," + "tempat_tugas ='" +jTextField6.getText() +"',waktu_tugas ='" +jTextField7.getText()+
                    "'," + "keterangan ='" +jTextArea1.getText()+"',keterangan2 ='" +jTextArea2.getText()+
                    "' WHERE id='" +id+"'");
            stmt.executeUpdate();
            JOptionPane.showMessageDialog(null, "Data berhasil diubah", "Pesan", JOptionPane.INFORMATION_MESSAGE);
            TampilData();
            clearData();
        } catch (SQLException e) {
            System.out.println(""+e);
            JOptionPane.showMessageDialog(null, "Data gagal diubah", "Pesan", 
                        JOptionPane.ERROR_MESSAGE);
        }
    }
//    
    public void deleteData(){
        Connection conn = Koneksi.getConnection();
        int confirm = JOptionPane.showConfirmDialog(null, "Apakah anda yakin ingin menghapus data tersebut?", 
                "Konfirmasi", JOptionPane.YES_NO_OPTION, JOptionPane.QUESTION_MESSAGE);
        if (confirm == 0) {
            try {
                Object id = jTable1.getValueAt(jTable1.getSelectedRow(), 0);
                java.sql.PreparedStatement stmt = conn.prepareStatement("delete from surat_tugas "
                        + "where id ='" + id + "'");
                stmt.executeUpdate();
                JOptionPane.showMessageDialog(null, "Data berhasil dihapus", "Pesan", 
                        JOptionPane.INFORMATION_MESSAGE);
                TampilData();
                clearData();
            } catch (SQLException e) {
                JOptionPane.showMessageDialog(null, "Data gagal di hapus", "Pesan", 
                        JOptionPane.ERROR_MESSAGE);
            }
        }
    }
    
    private void jDateChooser1PropertyChange(java.beans.PropertyChangeEvent evt) {//GEN-FIRST:event_jDateChooser1PropertyChange
        // TODO add your handling code here:
        try {
            if (jDateChooser1.getDate()!= null) {
                String tanggal = "yyyy-MM-dd";
                SimpleDateFormat format = new SimpleDateFormat (tanggal);
                dateChooser = String.valueOf(format.format(jDateChooser1.getDate()));
            }
        } catch (Exception e) {

        }
    }//GEN-LAST:event_jDateChooser1PropertyChange

    private void jButton6ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton6ActionPerformed
        // TODO add your handling code here:
        Connection conn = Koneksi.getConnection();
        try {
            FSurat_Tugas st = new FSurat_Tugas();
            String no_surat = jTextField3.getText();
            String tentang_surat = jTextField4.getText();
            String menugaskan = jComboBox1.getItemAt(jComboBox1.getSelectedIndex());
            st.Combox1(menugaskan);
            String tempat_tugas = jTextField6.getText();
            String waktu_tugas = jTextField7.getText();
            String keterangan1 = jTextArea1.getText();
            String keterangan2 = jTextArea2.getText();
            String folderPath = "C:\\simpati223";
            String filePath = "C:\\simpati223\\surat_tugas_"+menugaskan+".pdf";

            // Check if folder exists, create if it doesn't
            File folder = new File(folderPath);
            if (!folder.exists()) {
                boolean created = folder.mkdirs();
                if (created) {
                    System.out.println("Folder created successfully");
                } else {
                    System.out.println("Failed to create folder");
                }
            } else {
                System.out.println("Folder already exists");
            }

            // Check if file exists, create if it doesn't
            File file = new File(filePath);
            if (!file.exists()) {
                try {
                    boolean created = file.createNewFile();
                    if (created) {
                        //after created file, then we can create a content from pdf
                        //50 pertama itu left
                        //50 kedua itu right
                        Document document = new Document(PageSize.A4, 45, 65, 5, 50);
                        PdfWriter.getInstance(document, new FileOutputStream(filePath));

                        document.open();

                        // Create the header table
                        PdfPTable headerTable = new PdfPTable(1);
        //                headerTable.setWidthPercentage(100);
        //                headerTable.setWidths(new float[]{13, 87});

                        // Create the image cell
                        PdfPCell imageCell = new PdfPCell();
                        Image logo = Image.getInstance(getClass().getResource("/logo-jakarta-raya.jpeg"));
                        logo.scaleToFit(75, 200);
                        logo.setAlignment(Element.ALIGN_CENTER);
                        logo.setSpacingBefore(10f);
                        imageCell.addElement(logo);
                        imageCell.setRowspan(7);
                        imageCell.setBorder(PdfPCell.NO_BORDER);
                        headerTable.addCell(imageCell);

                        // Add the header table to the document
                        document.add(headerTable);

                        Paragraph para1 = new Paragraph("SEKOLAH MENENGAH PERTAMA NEGERI 223 JAKARTA", new Font(Font.FontFamily.TIMES_ROMAN, 14, Font.BOLD));
                        para1.setAlignment(Paragraph.ALIGN_CENTER);

                        Paragraph para2 = new Paragraph("DINAS PENDIDIKAN PROVINSI DKI JAKARTA", new Font(Font.FontFamily.TIMES_ROMAN, 14, Font.BOLD));
                        para2.setSpacingBefore(-5f);
                        para2.setAlignment(Paragraph.ALIGN_CENTER);
                        para2.setSpacingAfter(8f);

                        Paragraph para3 = new Paragraph("SURAT TUGAS", new Font(Font.FontFamily.TIMES_ROMAN, 15));
                        para3.setAlignment(Paragraph.ALIGN_CENTER);

                        Paragraph para4 = new Paragraph("Nomor : "+no_surat, new Font(Font.FontFamily.TIMES_ROMAN, 15));
                        para4.setSpacingBefore(-5f);
                        para4.setAlignment(Paragraph.ALIGN_CENTER);
                        para4.setSpacingAfter(8f);

                        Paragraph para5 = new Paragraph("TENTANG", new Font(Font.FontFamily.TIMES_ROMAN, 15));
                        para5.setAlignment(Paragraph.ALIGN_CENTER);

                        Paragraph para6 = new Paragraph(tentang_surat.toUpperCase(), new Font(Font.FontFamily.TIMES_ROMAN, 15));
                        para6.setSpacingBefore(-5f);
                        para6.setAlignment(Paragraph.ALIGN_CENTER);
                        para6.setSpacingAfter(8f);

                        Font boldFont = new Font(Font.FontFamily.TIMES_ROMAN, 14);
                        Paragraph para7 = new Paragraph("Yang bertanda tangan dibawah ini kepala SMP Negeri 223 Jakarta, dengan ini :", boldFont);
                        para7.setAlignment(Element.ALIGN_JUSTIFIED);
                        para7.setFirstLineIndent(70f);
                        para7.setSpacingAfter(8f);

                        Paragraph para8 = new Paragraph("MENUGASKAN :", new Font(Font.FontFamily.TIMES_ROMAN, 14));
                        para8.setAlignment(Paragraph.ALIGN_CENTER);

                        Paragraph para9 = new Paragraph("Kepada :", new Font(Font.FontFamily.TIMES_ROMAN, 14));
                        para9.setSpacingAfter(8f);

                        document.add(para1);
                        document.add(para2);
                        document.add(para3);
                        document.add(para4);
                        document.add(para5);
                        document.add(para6);
                        document.add(para7);
                        document.add(para8);
                        document.add(para9);

                        PdfPTable table2 = new PdfPTable(3);

                        // Set table properties
                        float[] columnWidth = {0.75f, 0.1f, 2f};
                        table2.setWidths(columnWidth);

                        Font data_font = new Font(Font.FontFamily.TIMES_ROMAN, 14);
                        PdfPCell cellOne = new PdfPCell(new Phrase("Nama",data_font));
                        PdfPCell cellTwo = new PdfPCell(new Phrase(":",data_font));
                        PdfPCell cellThree = new PdfPCell(new Phrase(menugaskan,data_font));

                        cellOne.setBorder(Rectangle.NO_BORDER);
                        cellTwo.setBorder(Rectangle.NO_BORDER);
                        cellThree.setBorder(Rectangle.NO_BORDER);
                        cellOne.setPaddingLeft(15f);

                        PdfPCell cellFour = new PdfPCell(new Phrase("NIKKI",data_font));
                        PdfPCell cellFive = new PdfPCell(new Phrase(":",data_font));
                        PdfPCell cellSix = new PdfPCell(new Phrase(st.nikki,data_font));

                        cellFour.setBorder(Rectangle.NO_BORDER);
                        cellFive.setBorder(Rectangle.NO_BORDER);
                        cellSix.setBorder(Rectangle.NO_BORDER);
                        cellFour.setPaddingLeft(15f);

                        PdfPCell cellSeven = new PdfPCell(new Phrase("Jabatan",data_font));
                        PdfPCell cellEight = new PdfPCell(new Phrase(":",data_font));
                        PdfPCell cellNine = new PdfPCell(new Phrase(st.jabatan,data_font));

                        cellSeven.setBorder(Rectangle.NO_BORDER);
                        cellEight.setBorder(Rectangle.NO_BORDER);
                        cellNine.setBorder(Rectangle.NO_BORDER);
                        cellSeven.setPaddingLeft(15f);

                        PdfPCell cellTen = new PdfPCell(new Phrase("Tempat Tugas",data_font));
                        PdfPCell cellEleven = new PdfPCell(new Phrase(":",data_font));
                        PdfPCell cellTwelve = new PdfPCell(new Phrase("SMP Negeri 223 Jakarta",data_font));

                        cellTen.setBorder(Rectangle.NO_BORDER);
                        cellEleven.setBorder(Rectangle.NO_BORDER);
                        cellTwelve.setBorder(Rectangle.NO_BORDER);
                        cellTen.setPaddingLeft(15f);

                        // Add table cells
                        table2.addCell(cellOne);
                        table2.addCell(cellTwo);
                        table2.addCell(cellThree);
                        table2.addCell(cellFour);
                        table2.addCell(cellFive);
                        table2.addCell(cellSix);
                        table2.addCell(cellSeven);
                        table2.addCell(cellEight);
                        table2.addCell(cellNine);
                        table2.addCell(cellTen);
                        table2.addCell(cellEleven);
                        table2.addCell(cellTwelve);

                        document.add(table2);

                        Paragraph para10 = new Paragraph("Untuk :", new Font(Font.FontFamily.TIMES_ROMAN, 14));
                        para10.setSpacingAfter(8f);

                        document.add(para10);

                        PdfPTable table3 = new PdfPTable(2);

                        // Set table properties
                        table3.setWidthPercentage(100);
                        float[] columnWidth3 = {0.16f, 2f};
                        table3.setWidths(columnWidth3);

                        PdfPCell content2_cellOne = new PdfPCell(new Phrase("1.",data_font));
                        PdfPCell content2_cellTwo = new PdfPCell(new Phrase(keterangan1,data_font));

                        content2_cellOne.setPaddingLeft(20f);
                        content2_cellOne.setBorder(Rectangle.NO_BORDER);
                        content2_cellTwo.setBorder(Rectangle.NO_BORDER);
                        content2_cellTwo.setHorizontalAlignment(Element.ALIGN_JUSTIFIED);
                        content2_cellTwo.setPaddingBottom(8f);

                        table3.addCell(content2_cellOne);
                        table3.addCell(content2_cellTwo);

                        document.add(table3);

                        PdfPTable table4 = new PdfPTable(3);

                        // Set table properties
                        table4.setWidthPercentage(100);
                        float[] columnWidth4 = {1.9f, 0.2f, 4f};
                        table4.setWidths(columnWidth4);
        //                table4.setWidths(columnWidth);

                        PdfPCell row2_cellOne = new PdfPCell(new Phrase("Hari",data_font));
                        PdfPCell row2_cellTwo = new PdfPCell(new Phrase(":",data_font));
                        PdfPCell row2_cellThree = new PdfPCell(new Phrase(Fungsi.getDayName(dateChooser),data_font));

                        row2_cellOne.setBorder(Rectangle.NO_BORDER);
                        row2_cellTwo.setBorder(Rectangle.NO_BORDER);
                        row2_cellThree.setBorder(Rectangle.NO_BORDER);
                        row2_cellOne.setPaddingLeft(65f);

                        PdfPCell row2_cellFour = new PdfPCell(new Phrase("Tanggal",data_font));
                        PdfPCell row2_cellFive = new PdfPCell(new Phrase(":",data_font));
                        PdfPCell row2_cellSix = new PdfPCell(new Phrase(Fungsi.getDate(dateChooser),data_font));

                        row2_cellFour.setBorder(Rectangle.NO_BORDER);
                        row2_cellFive.setBorder(Rectangle.NO_BORDER);
                        row2_cellSix.setBorder(Rectangle.NO_BORDER);
                        row2_cellFour.setPaddingLeft(65f);

                        PdfPCell row2_cellSeven = new PdfPCell(new Phrase("Waktu",data_font));
                        PdfPCell row2_cellEight = new PdfPCell(new Phrase(":",data_font));
                        PdfPCell row2_cellNine = new PdfPCell(new Phrase(waktu_tugas,data_font));

                        row2_cellSeven.setBorder(Rectangle.NO_BORDER);
                        row2_cellEight.setBorder(Rectangle.NO_BORDER);
                        row2_cellNine.setBorder(Rectangle.NO_BORDER);
                        row2_cellSeven.setPaddingLeft(65f);

                        PdfPCell row2_cellTen = new PdfPCell(new Phrase("Tempat",data_font));
                        PdfPCell row2_cellEleven = new PdfPCell(new Phrase(":",data_font));
                        PdfPCell row2_cellTwelve = new PdfPCell(new Phrase(tempat_tugas,data_font));

                        row2_cellTen.setBorder(Rectangle.NO_BORDER);
                        row2_cellEleven.setBorder(Rectangle.NO_BORDER);
                        row2_cellTwelve.setBorder(Rectangle.NO_BORDER);
                        row2_cellTen.setPaddingLeft(65f);
                        row2_cellTwelve.setPaddingBottom(5f);

                        // Add table cells
                        table4.addCell(row2_cellOne);
                        table4.addCell(row2_cellTwo);
                        table4.addCell(row2_cellThree);
                        table4.addCell(row2_cellFour);
                        table4.addCell(row2_cellFive);
                        table4.addCell(row2_cellSix);
                        table4.addCell(row2_cellSeven);
                        table4.addCell(row2_cellEight);
                        table4.addCell(row2_cellNine);
                        table4.addCell(row2_cellTen);
                        table4.addCell(row2_cellEleven);
                        table4.addCell(row2_cellTwelve);

                        document.add(table4);

                        PdfPTable table5 = new PdfPTable(2);

                        // Set table properties
                        table5.setWidthPercentage(100);
                        table5.setWidths(columnWidth3);

                        PdfPCell keterangan2_cellOne = new PdfPCell(new Phrase("2.",data_font));
                        PdfPCell keterangan2_cellTwo = new PdfPCell(new Phrase(keterangan2,data_font));

                        keterangan2_cellOne.setPaddingLeft(20f);
                        keterangan2_cellOne.setBorder(Rectangle.NO_BORDER);
                        keterangan2_cellTwo.setBorder(Rectangle.NO_BORDER);
                        keterangan2_cellTwo.setHorizontalAlignment(Element.ALIGN_JUSTIFIED);
                        keterangan2_cellTwo.setPaddingBottom(8f);

                        table5.addCell(keterangan2_cellOne);
                        table5.addCell(keterangan2_cellTwo);

                        document.add(table5);

                        Paragraph para11 = new Paragraph("Surat Tugas ini dibuat untuk dilaksanakan dengan sebaik-baiknya dan penuh tanggung jawab.", boldFont);
                        para11.setAlignment(Element.ALIGN_JUSTIFIED);
                        para11.setFirstLineIndent(70f);
                        para11.setSpacingAfter(8f);

                        document.add(para11);

                        // Create the content table
                        PdfPTable contentTable3 = new PdfPTable(1);
                        contentTable3.setWidthPercentage(48);
                        contentTable3.setHorizontalAlignment(Element.ALIGN_RIGHT);

                        // Add the content rows to the table
                        PdfPCell cell_footer_tempat = new PdfPCell(new Phrase("Dikeluarkan di Jakarta", new Font(Font.FontFamily.TIMES_ROMAN,14)));
                        cell_footer_tempat.setBorder(PdfPCell.NO_BORDER);                
                        contentTable3.addCell(cell_footer_tempat);

                        PdfPCell cell_footer_tgl = new PdfPCell(new Phrase("pada tanggal "+Fungsi.getDate(dateChooser), new Font(Font.FontFamily.TIMES_ROMAN,14)));
                        cell_footer_tgl.setBorder(PdfPCell.NO_BORDER); 
                        cell_footer_tgl.setPaddingBottom(8f);
                        contentTable3.addCell(cell_footer_tgl);

                        PdfPCell cell_footer2 = new PdfPCell(new Phrase("Kepala SMP Negeri 223 Jakarta", new Font(Font.FontFamily.TIMES_ROMAN,14)));
                        cell_footer2.setBorder(PdfPCell.NO_BORDER);  
                        cell_footer2.setPaddingBottom(58f);
                        contentTable3.addCell(cell_footer2);

                        // Add the content rows to the table
                        PdfPCell cell_footer3 = new PdfPCell(new Phrase("OMAN NURYANI, M.Pd.", new Font(Font.FontFamily.TIMES_ROMAN,14)));
                        cell_footer3.setBorder(PdfPCell.NO_BORDER);                
                        contentTable3.addCell(cell_footer3);

                        PdfPCell cell_footer4 = new PdfPCell(new Phrase("NIP. 196807191997031003", new Font(Font.FontFamily.TIMES_ROMAN,14)));
                        cell_footer4.setBorder(PdfPCell.NO_BORDER);  
                        contentTable3.addCell(cell_footer4);

                        document.add(contentTable3);

                        document.close();
                        System.out.println("File created successfully");
                    }else{
                        System.out.println("Failed to create file");
                    }
                } catch (IOException e) {
                    System.out.println(e);
                    System.out.println("An error occurred while creating the file: " + e.getMessage());
                }
            }else{
                //if file exist, then we can create the content from pdf
                //50 pertama itu left
                //50 kedua itu right
                Document document = new Document(PageSize.A4, 45, 65, 5, 50);
                PdfWriter.getInstance(document, new FileOutputStream(filePath));

                document.open();

                // Create the header table
                PdfPTable headerTable = new PdfPTable(1);
//                headerTable.setWidthPercentage(100);
//                headerTable.setWidths(new float[]{13, 87});

                // Create the image cell
                PdfPCell imageCell = new PdfPCell();
                Image logo = Image.getInstance(getClass().getResource("/logo-jakarta-raya.jpeg"));
                logo.scaleToFit(75, 200);
                logo.setAlignment(Element.ALIGN_CENTER);
                logo.setSpacingBefore(10f);
                imageCell.addElement(logo);
                imageCell.setRowspan(7);
                imageCell.setBorder(PdfPCell.NO_BORDER);
                headerTable.addCell(imageCell);

                // Add the header table to the document
                document.add(headerTable);
                
                Paragraph para1 = new Paragraph("SEKOLAH MENENGAH PERTAMA NEGERI 223 JAKARTA", new Font(Font.FontFamily.TIMES_ROMAN, 14, Font.BOLD));
                para1.setAlignment(Paragraph.ALIGN_CENTER);
                
                Paragraph para2 = new Paragraph("DINAS PENDIDIKAN PROVINSI DKI JAKARTA", new Font(Font.FontFamily.TIMES_ROMAN, 14, Font.BOLD));
                para2.setSpacingBefore(-5f);
                para2.setAlignment(Paragraph.ALIGN_CENTER);
                para2.setSpacingAfter(8f);
                
                Paragraph para3 = new Paragraph("SURAT TUGAS", new Font(Font.FontFamily.TIMES_ROMAN, 15));
                para3.setAlignment(Paragraph.ALIGN_CENTER);
                
                Paragraph para4 = new Paragraph("Nomor : "+no_surat, new Font(Font.FontFamily.TIMES_ROMAN, 15));
                para4.setSpacingBefore(-5f);
                para4.setAlignment(Paragraph.ALIGN_CENTER);
                para4.setSpacingAfter(8f);
                
                Paragraph para5 = new Paragraph("TENTANG", new Font(Font.FontFamily.TIMES_ROMAN, 15));
                para5.setAlignment(Paragraph.ALIGN_CENTER);
                
                Paragraph para6 = new Paragraph(tentang_surat.toUpperCase(), new Font(Font.FontFamily.TIMES_ROMAN, 15));
                para6.setSpacingBefore(-5f);
                para6.setAlignment(Paragraph.ALIGN_CENTER);
                para6.setSpacingAfter(8f);
                
                Font boldFont = new Font(Font.FontFamily.TIMES_ROMAN, 14);
                Paragraph para7 = new Paragraph("Yang bertanda tangan dibawah ini kepala SMP Negeri 223 Jakarta, dengan ini :", boldFont);
                para7.setAlignment(Element.ALIGN_JUSTIFIED);
                para7.setFirstLineIndent(70f);
                para7.setSpacingAfter(8f);
                
                Paragraph para8 = new Paragraph("MENUGASKAN :", new Font(Font.FontFamily.TIMES_ROMAN, 14));
                para8.setAlignment(Paragraph.ALIGN_CENTER);
                
                Paragraph para9 = new Paragraph("Kepada :", new Font(Font.FontFamily.TIMES_ROMAN, 14));
                para9.setSpacingAfter(8f);
                
                document.add(para1);
                document.add(para2);
                document.add(para3);
                document.add(para4);
                document.add(para5);
                document.add(para6);
                document.add(para7);
                document.add(para8);
                document.add(para9);
                
                PdfPTable table2 = new PdfPTable(3);

                // Set table properties
                float[] columnWidth = {0.75f, 0.1f, 2f};
                table2.setWidths(columnWidth);

                Font data_font = new Font(Font.FontFamily.TIMES_ROMAN, 14);
                PdfPCell cellOne = new PdfPCell(new Phrase("Nama",data_font));
                PdfPCell cellTwo = new PdfPCell(new Phrase(":",data_font));
                PdfPCell cellThree = new PdfPCell(new Phrase(menugaskan,data_font));

                cellOne.setBorder(Rectangle.NO_BORDER);
                cellTwo.setBorder(Rectangle.NO_BORDER);
                cellThree.setBorder(Rectangle.NO_BORDER);
                cellOne.setPaddingLeft(15f);

                PdfPCell cellFour = new PdfPCell(new Phrase("NIKKI",data_font));
                PdfPCell cellFive = new PdfPCell(new Phrase(":",data_font));
                PdfPCell cellSix = new PdfPCell(new Phrase(st.nikki,data_font));

                cellFour.setBorder(Rectangle.NO_BORDER);
                cellFive.setBorder(Rectangle.NO_BORDER);
                cellSix.setBorder(Rectangle.NO_BORDER);
                cellFour.setPaddingLeft(15f);
                
                PdfPCell cellSeven = new PdfPCell(new Phrase("Jabatan",data_font));
                PdfPCell cellEight = new PdfPCell(new Phrase(":",data_font));
                PdfPCell cellNine = new PdfPCell(new Phrase(st.jabatan,data_font));

                cellSeven.setBorder(Rectangle.NO_BORDER);
                cellEight.setBorder(Rectangle.NO_BORDER);
                cellNine.setBorder(Rectangle.NO_BORDER);
                cellSeven.setPaddingLeft(15f);
                
                PdfPCell cellTen = new PdfPCell(new Phrase("Tempat Tugas",data_font));
                PdfPCell cellEleven = new PdfPCell(new Phrase(":",data_font));
                PdfPCell cellTwelve = new PdfPCell(new Phrase("SMP Negeri 223 Jakarta",data_font));

                cellTen.setBorder(Rectangle.NO_BORDER);
                cellEleven.setBorder(Rectangle.NO_BORDER);
                cellTwelve.setBorder(Rectangle.NO_BORDER);
                cellTen.setPaddingLeft(15f);
                
                // Add table cells
                table2.addCell(cellOne);
                table2.addCell(cellTwo);
                table2.addCell(cellThree);
                table2.addCell(cellFour);
                table2.addCell(cellFive);
                table2.addCell(cellSix);
                table2.addCell(cellSeven);
                table2.addCell(cellEight);
                table2.addCell(cellNine);
                table2.addCell(cellTen);
                table2.addCell(cellEleven);
                table2.addCell(cellTwelve);
                
                document.add(table2);
                
                Paragraph para10 = new Paragraph("Untuk :", new Font(Font.FontFamily.TIMES_ROMAN, 14));
                para10.setSpacingAfter(8f);
                
                document.add(para10);
                
                PdfPTable table3 = new PdfPTable(2);
                
                // Set table properties
                table3.setWidthPercentage(100);
                float[] columnWidth3 = {0.16f, 2f};
                table3.setWidths(columnWidth3);
                
                PdfPCell content2_cellOne = new PdfPCell(new Phrase("1.",data_font));
                PdfPCell content2_cellTwo = new PdfPCell(new Phrase(keterangan1,data_font));
                
                content2_cellOne.setPaddingLeft(20f);
                content2_cellOne.setBorder(Rectangle.NO_BORDER);
                content2_cellTwo.setBorder(Rectangle.NO_BORDER);
                content2_cellTwo.setHorizontalAlignment(Element.ALIGN_JUSTIFIED);
                content2_cellTwo.setPaddingBottom(8f);
                
                table3.addCell(content2_cellOne);
                table3.addCell(content2_cellTwo);
                
                document.add(table3);
                
                PdfPTable table4 = new PdfPTable(3);

                // Set table properties
                table4.setWidthPercentage(100);
                float[] columnWidth4 = {1.9f, 0.2f, 4f};
                table4.setWidths(columnWidth4);
//                table4.setWidths(columnWidth);

                PdfPCell row2_cellOne = new PdfPCell(new Phrase("Hari",data_font));
                PdfPCell row2_cellTwo = new PdfPCell(new Phrase(":",data_font));
                PdfPCell row2_cellThree = new PdfPCell(new Phrase(Fungsi.getDayName(dateChooser),data_font));

                row2_cellOne.setBorder(Rectangle.NO_BORDER);
                row2_cellTwo.setBorder(Rectangle.NO_BORDER);
                row2_cellThree.setBorder(Rectangle.NO_BORDER);
                row2_cellOne.setPaddingLeft(65f);

                PdfPCell row2_cellFour = new PdfPCell(new Phrase("Tanggal",data_font));
                PdfPCell row2_cellFive = new PdfPCell(new Phrase(":",data_font));
                PdfPCell row2_cellSix = new PdfPCell(new Phrase(Fungsi.getDate(dateChooser),data_font));

                row2_cellFour.setBorder(Rectangle.NO_BORDER);
                row2_cellFive.setBorder(Rectangle.NO_BORDER);
                row2_cellSix.setBorder(Rectangle.NO_BORDER);
                row2_cellFour.setPaddingLeft(65f);
                
                PdfPCell row2_cellSeven = new PdfPCell(new Phrase("Waktu",data_font));
                PdfPCell row2_cellEight = new PdfPCell(new Phrase(":",data_font));
                PdfPCell row2_cellNine = new PdfPCell(new Phrase(waktu_tugas,data_font));

                row2_cellSeven.setBorder(Rectangle.NO_BORDER);
                row2_cellEight.setBorder(Rectangle.NO_BORDER);
                row2_cellNine.setBorder(Rectangle.NO_BORDER);
                row2_cellSeven.setPaddingLeft(65f);
                
                PdfPCell row2_cellTen = new PdfPCell(new Phrase("Tempat",data_font));
                PdfPCell row2_cellEleven = new PdfPCell(new Phrase(":",data_font));
                PdfPCell row2_cellTwelve = new PdfPCell(new Phrase(tempat_tugas,data_font));

                row2_cellTen.setBorder(Rectangle.NO_BORDER);
                row2_cellEleven.setBorder(Rectangle.NO_BORDER);
                row2_cellTwelve.setBorder(Rectangle.NO_BORDER);
                row2_cellTen.setPaddingLeft(65f);
                row2_cellTwelve.setPaddingBottom(5f);
                
                // Add table cells
                table4.addCell(row2_cellOne);
                table4.addCell(row2_cellTwo);
                table4.addCell(row2_cellThree);
                table4.addCell(row2_cellFour);
                table4.addCell(row2_cellFive);
                table4.addCell(row2_cellSix);
                table4.addCell(row2_cellSeven);
                table4.addCell(row2_cellEight);
                table4.addCell(row2_cellNine);
                table4.addCell(row2_cellTen);
                table4.addCell(row2_cellEleven);
                table4.addCell(row2_cellTwelve);
                
                document.add(table4);
                
                PdfPTable table5 = new PdfPTable(2);
                
                // Set table properties
                table5.setWidthPercentage(100);
                table5.setWidths(columnWidth3);
                
                PdfPCell keterangan2_cellOne = new PdfPCell(new Phrase("2.",data_font));
                PdfPCell keterangan2_cellTwo = new PdfPCell(new Phrase(keterangan2,data_font));
                
                keterangan2_cellOne.setPaddingLeft(20f);
                keterangan2_cellOne.setBorder(Rectangle.NO_BORDER);
                keterangan2_cellTwo.setBorder(Rectangle.NO_BORDER);
                keterangan2_cellTwo.setHorizontalAlignment(Element.ALIGN_JUSTIFIED);
                keterangan2_cellTwo.setPaddingBottom(8f);
                
                table5.addCell(keterangan2_cellOne);
                table5.addCell(keterangan2_cellTwo);
                
                document.add(table5);
                
                Paragraph para11 = new Paragraph("Surat Tugas ini dibuat untuk dilaksanakan dengan sebaik-baiknya dan penuh tanggung jawab.", boldFont);
                para11.setAlignment(Element.ALIGN_JUSTIFIED);
                para11.setFirstLineIndent(70f);
                para11.setSpacingAfter(8f);
                
                document.add(para11);
                
                // Create the content table
                PdfPTable contentTable3 = new PdfPTable(1);
                contentTable3.setWidthPercentage(48);
                contentTable3.setHorizontalAlignment(Element.ALIGN_RIGHT);
                
                // Add the content rows to the table
                PdfPCell cell_footer_tempat = new PdfPCell(new Phrase("Dikeluarkan di Jakarta", new Font(Font.FontFamily.TIMES_ROMAN,14)));
                cell_footer_tempat.setBorder(PdfPCell.NO_BORDER);                
                contentTable3.addCell(cell_footer_tempat);
                
                PdfPCell cell_footer_tgl = new PdfPCell(new Phrase("pada tanggal "+Fungsi.getDate(dateChooser), new Font(Font.FontFamily.TIMES_ROMAN,14)));
                cell_footer_tgl.setBorder(PdfPCell.NO_BORDER); 
                cell_footer_tgl.setPaddingBottom(8f);
                contentTable3.addCell(cell_footer_tgl);
                
                PdfPCell cell_footer2 = new PdfPCell(new Phrase("Kepala SMP Negeri 223 Jakarta", new Font(Font.FontFamily.TIMES_ROMAN,14)));
                cell_footer2.setBorder(PdfPCell.NO_BORDER);  
                cell_footer2.setPaddingBottom(58f);
                contentTable3.addCell(cell_footer2);
                
                // Add the content rows to the table
                PdfPCell cell_footer3 = new PdfPCell(new Phrase("OMAN NURYANI, M.Pd.", new Font(Font.FontFamily.TIMES_ROMAN,14)));
                cell_footer3.setBorder(PdfPCell.NO_BORDER);                
                contentTable3.addCell(cell_footer3);
                
                PdfPCell cell_footer4 = new PdfPCell(new Phrase("NIP. 196807191997031003", new Font(Font.FontFamily.TIMES_ROMAN,14)));
                cell_footer4.setBorder(PdfPCell.NO_BORDER);  
                contentTable3.addCell(cell_footer4);
                
                document.add(contentTable3);
                
                document.close();
                System.out.println("File created successfully");
            }
            File file1 = new File(filePath);

            JOptionPane.showMessageDialog(null, "Data berhasil dicetak", "Pesan", JOptionPane.INFORMATION_MESSAGE);
            // Open the URL in the default web browser
            Desktop.getDesktop().open(file1);
        } catch (Exception e) {
                System.out.println(e);
        }
    }//GEN-LAST:event_jButton6ActionPerformed

    private void jButton6KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jButton6KeyPressed
        // TODO add your handling code here:
        if(evt.getKeyCode()==KeyEvent.VK_ENTER){
            Connection conn = Koneksi.getConnection();
            try {
                FSurat_Tugas st = new FSurat_Tugas();
                String no_surat = jTextField3.getText();
                String tentang_surat = jTextField4.getText();
                String menugaskan = jComboBox1.getItemAt(jComboBox1.getSelectedIndex());
                st.Combox1(menugaskan);
                String tempat_tugas = jTextField6.getText();
                String waktu_tugas = jTextField7.getText();
                String keterangan1 = jTextArea1.getText();
                String keterangan2 = jTextArea2.getText();
                String folderPath = "C:\\simpati223";
                String filePath = "C:\\simpati223\\surat_tugas_"+menugaskan+".pdf";

                // Check if folder exists, create if it doesn't
                File folder = new File(folderPath);
                if (!folder.exists()) {
                    boolean created = folder.mkdirs();
                    if (created) {
                        System.out.println("Folder created successfully");
                    } else {
                        System.out.println("Failed to create folder");
                    }
                } else {
                    System.out.println("Folder already exists");
                }

                // Check if file exists, create if it doesn't
                File file = new File(filePath);
                if (!file.exists()) {
                    try {
                        boolean created = file.createNewFile();
                        if (created) {
                            //after created file, then we can create a content from pdf
                            //50 pertama itu left
                            //50 kedua itu right
                            Document document = new Document(PageSize.A4, 45, 65, 5, 50);
                            PdfWriter.getInstance(document, new FileOutputStream(filePath));

                            document.open();

                            // Create the header table
                            PdfPTable headerTable = new PdfPTable(1);
            //                headerTable.setWidthPercentage(100);
            //                headerTable.setWidths(new float[]{13, 87});

                            // Create the image cell
                            PdfPCell imageCell = new PdfPCell();
                            Image logo = Image.getInstance(getClass().getResource("/logo-jakarta-raya.jpeg"));
                            logo.scaleToFit(75, 200);
                            logo.setAlignment(Element.ALIGN_CENTER);
                            logo.setSpacingBefore(10f);
                            imageCell.addElement(logo);
                            imageCell.setRowspan(7);
                            imageCell.setBorder(PdfPCell.NO_BORDER);
                            headerTable.addCell(imageCell);

                            // Add the header table to the document
                            document.add(headerTable);

                            Paragraph para1 = new Paragraph("SEKOLAH MENENGAH PERTAMA NEGERI 223 JAKARTA", new Font(Font.FontFamily.TIMES_ROMAN, 14, Font.BOLD));
                            para1.setAlignment(Paragraph.ALIGN_CENTER);

                            Paragraph para2 = new Paragraph("DINAS PENDIDIKAN PROVINSI DKI JAKARTA", new Font(Font.FontFamily.TIMES_ROMAN, 14, Font.BOLD));
                            para2.setSpacingBefore(-5f);
                            para2.setAlignment(Paragraph.ALIGN_CENTER);
                            para2.setSpacingAfter(8f);

                            Paragraph para3 = new Paragraph("SURAT TUGAS", new Font(Font.FontFamily.TIMES_ROMAN, 15));
                            para3.setAlignment(Paragraph.ALIGN_CENTER);

                            Paragraph para4 = new Paragraph("Nomor : "+no_surat, new Font(Font.FontFamily.TIMES_ROMAN, 15));
                            para4.setSpacingBefore(-5f);
                            para4.setAlignment(Paragraph.ALIGN_CENTER);
                            para4.setSpacingAfter(8f);

                            Paragraph para5 = new Paragraph("TENTANG", new Font(Font.FontFamily.TIMES_ROMAN, 15));
                            para5.setAlignment(Paragraph.ALIGN_CENTER);

                            Paragraph para6 = new Paragraph(tentang_surat.toUpperCase(), new Font(Font.FontFamily.TIMES_ROMAN, 15));
                            para6.setSpacingBefore(-5f);
                            para6.setAlignment(Paragraph.ALIGN_CENTER);
                            para6.setSpacingAfter(8f);

                            Font boldFont = new Font(Font.FontFamily.TIMES_ROMAN, 14);
                            Paragraph para7 = new Paragraph("Yang bertanda tangan dibawah ini kepala SMP Negeri 223 Jakarta, dengan ini :", boldFont);
                            para7.setAlignment(Element.ALIGN_JUSTIFIED);
                            para7.setFirstLineIndent(70f);
                            para7.setSpacingAfter(8f);

                            Paragraph para8 = new Paragraph("MENUGASKAN :", new Font(Font.FontFamily.TIMES_ROMAN, 14));
                            para8.setAlignment(Paragraph.ALIGN_CENTER);

                            Paragraph para9 = new Paragraph("Kepada :", new Font(Font.FontFamily.TIMES_ROMAN, 14));
                            para9.setSpacingAfter(8f);

                            document.add(para1);
                            document.add(para2);
                            document.add(para3);
                            document.add(para4);
                            document.add(para5);
                            document.add(para6);
                            document.add(para7);
                            document.add(para8);
                            document.add(para9);

                            PdfPTable table2 = new PdfPTable(3);

                            // Set table properties
                            float[] columnWidth = {0.75f, 0.1f, 2f};
                            table2.setWidths(columnWidth);

                            Font data_font = new Font(Font.FontFamily.TIMES_ROMAN, 14);
                            PdfPCell cellOne = new PdfPCell(new Phrase("Nama",data_font));
                            PdfPCell cellTwo = new PdfPCell(new Phrase(":",data_font));
                            PdfPCell cellThree = new PdfPCell(new Phrase(menugaskan,data_font));

                            cellOne.setBorder(Rectangle.NO_BORDER);
                            cellTwo.setBorder(Rectangle.NO_BORDER);
                            cellThree.setBorder(Rectangle.NO_BORDER);
                            cellOne.setPaddingLeft(15f);

                            PdfPCell cellFour = new PdfPCell(new Phrase("NIKKI",data_font));
                            PdfPCell cellFive = new PdfPCell(new Phrase(":",data_font));
                            PdfPCell cellSix = new PdfPCell(new Phrase(st.nikki,data_font));

                            cellFour.setBorder(Rectangle.NO_BORDER);
                            cellFive.setBorder(Rectangle.NO_BORDER);
                            cellSix.setBorder(Rectangle.NO_BORDER);
                            cellFour.setPaddingLeft(15f);

                            PdfPCell cellSeven = new PdfPCell(new Phrase("Jabatan",data_font));
                            PdfPCell cellEight = new PdfPCell(new Phrase(":",data_font));
                            PdfPCell cellNine = new PdfPCell(new Phrase(st.jabatan,data_font));

                            cellSeven.setBorder(Rectangle.NO_BORDER);
                            cellEight.setBorder(Rectangle.NO_BORDER);
                            cellNine.setBorder(Rectangle.NO_BORDER);
                            cellSeven.setPaddingLeft(15f);

                            PdfPCell cellTen = new PdfPCell(new Phrase("Tempat Tugas",data_font));
                            PdfPCell cellEleven = new PdfPCell(new Phrase(":",data_font));
                            PdfPCell cellTwelve = new PdfPCell(new Phrase("SMP Negeri 223 Jakarta",data_font));

                            cellTen.setBorder(Rectangle.NO_BORDER);
                            cellEleven.setBorder(Rectangle.NO_BORDER);
                            cellTwelve.setBorder(Rectangle.NO_BORDER);
                            cellTen.setPaddingLeft(15f);

                            // Add table cells
                            table2.addCell(cellOne);
                            table2.addCell(cellTwo);
                            table2.addCell(cellThree);
                            table2.addCell(cellFour);
                            table2.addCell(cellFive);
                            table2.addCell(cellSix);
                            table2.addCell(cellSeven);
                            table2.addCell(cellEight);
                            table2.addCell(cellNine);
                            table2.addCell(cellTen);
                            table2.addCell(cellEleven);
                            table2.addCell(cellTwelve);

                            document.add(table2);

                            Paragraph para10 = new Paragraph("Untuk :", new Font(Font.FontFamily.TIMES_ROMAN, 14));
                            para10.setSpacingAfter(8f);

                            document.add(para10);

                            PdfPTable table3 = new PdfPTable(2);

                            // Set table properties
                            table3.setWidthPercentage(100);
                            float[] columnWidth3 = {0.16f, 2f};
                            table3.setWidths(columnWidth3);

                            PdfPCell content2_cellOne = new PdfPCell(new Phrase("1.",data_font));
                            PdfPCell content2_cellTwo = new PdfPCell(new Phrase(keterangan1,data_font));

                            content2_cellOne.setPaddingLeft(20f);
                            content2_cellOne.setBorder(Rectangle.NO_BORDER);
                            content2_cellTwo.setBorder(Rectangle.NO_BORDER);
                            content2_cellTwo.setHorizontalAlignment(Element.ALIGN_JUSTIFIED);
                            content2_cellTwo.setPaddingBottom(8f);

                            table3.addCell(content2_cellOne);
                            table3.addCell(content2_cellTwo);

                            document.add(table3);

                            PdfPTable table4 = new PdfPTable(3);

                            // Set table properties
                            table4.setWidthPercentage(100);
                            float[] columnWidth4 = {1.9f, 0.2f, 4f};
                            table4.setWidths(columnWidth4);
            //                table4.setWidths(columnWidth);

                            PdfPCell row2_cellOne = new PdfPCell(new Phrase("Hari",data_font));
                            PdfPCell row2_cellTwo = new PdfPCell(new Phrase(":",data_font));
                            PdfPCell row2_cellThree = new PdfPCell(new Phrase(Fungsi.getDayName(dateChooser),data_font));

                            row2_cellOne.setBorder(Rectangle.NO_BORDER);
                            row2_cellTwo.setBorder(Rectangle.NO_BORDER);
                            row2_cellThree.setBorder(Rectangle.NO_BORDER);
                            row2_cellOne.setPaddingLeft(65f);

                            PdfPCell row2_cellFour = new PdfPCell(new Phrase("Tanggal",data_font));
                            PdfPCell row2_cellFive = new PdfPCell(new Phrase(":",data_font));
                            PdfPCell row2_cellSix = new PdfPCell(new Phrase(Fungsi.getDate(dateChooser),data_font));

                            row2_cellFour.setBorder(Rectangle.NO_BORDER);
                            row2_cellFive.setBorder(Rectangle.NO_BORDER);
                            row2_cellSix.setBorder(Rectangle.NO_BORDER);
                            row2_cellFour.setPaddingLeft(65f);

                            PdfPCell row2_cellSeven = new PdfPCell(new Phrase("Waktu",data_font));
                            PdfPCell row2_cellEight = new PdfPCell(new Phrase(":",data_font));
                            PdfPCell row2_cellNine = new PdfPCell(new Phrase(waktu_tugas,data_font));

                            row2_cellSeven.setBorder(Rectangle.NO_BORDER);
                            row2_cellEight.setBorder(Rectangle.NO_BORDER);
                            row2_cellNine.setBorder(Rectangle.NO_BORDER);
                            row2_cellSeven.setPaddingLeft(65f);

                            PdfPCell row2_cellTen = new PdfPCell(new Phrase("Tempat",data_font));
                            PdfPCell row2_cellEleven = new PdfPCell(new Phrase(":",data_font));
                            PdfPCell row2_cellTwelve = new PdfPCell(new Phrase(tempat_tugas,data_font));

                            row2_cellTen.setBorder(Rectangle.NO_BORDER);
                            row2_cellEleven.setBorder(Rectangle.NO_BORDER);
                            row2_cellTwelve.setBorder(Rectangle.NO_BORDER);
                            row2_cellTen.setPaddingLeft(65f);
                            row2_cellTwelve.setPaddingBottom(5f);

                            // Add table cells
                            table4.addCell(row2_cellOne);
                            table4.addCell(row2_cellTwo);
                            table4.addCell(row2_cellThree);
                            table4.addCell(row2_cellFour);
                            table4.addCell(row2_cellFive);
                            table4.addCell(row2_cellSix);
                            table4.addCell(row2_cellSeven);
                            table4.addCell(row2_cellEight);
                            table4.addCell(row2_cellNine);
                            table4.addCell(row2_cellTen);
                            table4.addCell(row2_cellEleven);
                            table4.addCell(row2_cellTwelve);

                            document.add(table4);

                            PdfPTable table5 = new PdfPTable(2);

                            // Set table properties
                            table5.setWidthPercentage(100);
                            table5.setWidths(columnWidth3);

                            PdfPCell keterangan2_cellOne = new PdfPCell(new Phrase("2.",data_font));
                            PdfPCell keterangan2_cellTwo = new PdfPCell(new Phrase(keterangan2,data_font));

                            keterangan2_cellOne.setPaddingLeft(20f);
                            keterangan2_cellOne.setBorder(Rectangle.NO_BORDER);
                            keterangan2_cellTwo.setBorder(Rectangle.NO_BORDER);
                            keterangan2_cellTwo.setHorizontalAlignment(Element.ALIGN_JUSTIFIED);
                            keterangan2_cellTwo.setPaddingBottom(8f);

                            table5.addCell(keterangan2_cellOne);
                            table5.addCell(keterangan2_cellTwo);

                            document.add(table5);

                            Paragraph para11 = new Paragraph("Surat Tugas ini dibuat untuk dilaksanakan dengan sebaik-baiknya dan penuh tanggung jawab.", boldFont);
                            para11.setAlignment(Element.ALIGN_JUSTIFIED);
                            para11.setFirstLineIndent(70f);
                            para11.setSpacingAfter(8f);

                            document.add(para11);

                            // Create the content table
                            PdfPTable contentTable3 = new PdfPTable(1);
                            contentTable3.setWidthPercentage(48);
                            contentTable3.setHorizontalAlignment(Element.ALIGN_RIGHT);

                            // Add the content rows to the table
                            PdfPCell cell_footer_tempat = new PdfPCell(new Phrase("Dikeluarkan di Jakarta", new Font(Font.FontFamily.TIMES_ROMAN,14)));
                            cell_footer_tempat.setBorder(PdfPCell.NO_BORDER);                
                            contentTable3.addCell(cell_footer_tempat);

                            PdfPCell cell_footer_tgl = new PdfPCell(new Phrase("pada tanggal "+Fungsi.getDate(dateChooser), new Font(Font.FontFamily.TIMES_ROMAN,14)));
                            cell_footer_tgl.setBorder(PdfPCell.NO_BORDER); 
                            cell_footer_tgl.setPaddingBottom(8f);
                            contentTable3.addCell(cell_footer_tgl);

                            PdfPCell cell_footer2 = new PdfPCell(new Phrase("Kepala SMP Negeri 223 Jakarta", new Font(Font.FontFamily.TIMES_ROMAN,14)));
                            cell_footer2.setBorder(PdfPCell.NO_BORDER);  
                            cell_footer2.setPaddingBottom(58f);
                            contentTable3.addCell(cell_footer2);

                            // Add the content rows to the table
                            PdfPCell cell_footer3 = new PdfPCell(new Phrase("OMAN NURYANI, M.Pd.", new Font(Font.FontFamily.TIMES_ROMAN,14)));
                            cell_footer3.setBorder(PdfPCell.NO_BORDER);                
                            contentTable3.addCell(cell_footer3);

                            PdfPCell cell_footer4 = new PdfPCell(new Phrase("NIP. 196807191997031003", new Font(Font.FontFamily.TIMES_ROMAN,14)));
                            cell_footer4.setBorder(PdfPCell.NO_BORDER);  
                            contentTable3.addCell(cell_footer4);

                            document.add(contentTable3);

                            document.close();
                            System.out.println("File created successfully");
                        }else{
                            System.out.println("Failed to create file");
                        }
                    } catch (IOException e) {
                        System.out.println(e);
                        System.out.println("An error occurred while creating the file: " + e.getMessage());
                    }
                }else{
                    //if file exist, then we can create the content from pdf
                    //50 pertama itu left
                    //50 kedua itu right
                    Document document = new Document(PageSize.A4, 45, 65, 5, 50);
                    PdfWriter.getInstance(document, new FileOutputStream(filePath));

                    document.open();

                    // Create the header table
                    PdfPTable headerTable = new PdfPTable(1);
    //                headerTable.setWidthPercentage(100);
    //                headerTable.setWidths(new float[]{13, 87});

                    // Create the image cell
                    PdfPCell imageCell = new PdfPCell();
                    Image logo = Image.getInstance(getClass().getResource("/logo-jakarta-raya.jpeg"));
                    logo.scaleToFit(75, 200);
                    logo.setAlignment(Element.ALIGN_CENTER);
                    logo.setSpacingBefore(10f);
                    imageCell.addElement(logo);
                    imageCell.setRowspan(7);
                    imageCell.setBorder(PdfPCell.NO_BORDER);
                    headerTable.addCell(imageCell);

                    // Add the header table to the document
                    document.add(headerTable);

                    Paragraph para1 = new Paragraph("SEKOLAH MENENGAH PERTAMA NEGERI 223 JAKARTA", new Font(Font.FontFamily.TIMES_ROMAN, 14, Font.BOLD));
                    para1.setAlignment(Paragraph.ALIGN_CENTER);

                    Paragraph para2 = new Paragraph("DINAS PENDIDIKAN PROVINSI DKI JAKARTA", new Font(Font.FontFamily.TIMES_ROMAN, 14, Font.BOLD));
                    para2.setSpacingBefore(-5f);
                    para2.setAlignment(Paragraph.ALIGN_CENTER);
                    para2.setSpacingAfter(8f);

                    Paragraph para3 = new Paragraph("SURAT TUGAS", new Font(Font.FontFamily.TIMES_ROMAN, 15));
                    para3.setAlignment(Paragraph.ALIGN_CENTER);

                    Paragraph para4 = new Paragraph("Nomor : "+no_surat, new Font(Font.FontFamily.TIMES_ROMAN, 15));
                    para4.setSpacingBefore(-5f);
                    para4.setAlignment(Paragraph.ALIGN_CENTER);
                    para4.setSpacingAfter(8f);

                    Paragraph para5 = new Paragraph("TENTANG", new Font(Font.FontFamily.TIMES_ROMAN, 15));
                    para5.setAlignment(Paragraph.ALIGN_CENTER);

                    Paragraph para6 = new Paragraph(tentang_surat.toUpperCase(), new Font(Font.FontFamily.TIMES_ROMAN, 15));
                    para6.setSpacingBefore(-5f);
                    para6.setAlignment(Paragraph.ALIGN_CENTER);
                    para6.setSpacingAfter(8f);

                    Font boldFont = new Font(Font.FontFamily.TIMES_ROMAN, 14);
                    Paragraph para7 = new Paragraph("Yang bertanda tangan dibawah ini kepala SMP Negeri 223 Jakarta, dengan ini :", boldFont);
                    para7.setAlignment(Element.ALIGN_JUSTIFIED);
                    para7.setFirstLineIndent(70f);
                    para7.setSpacingAfter(8f);

                    Paragraph para8 = new Paragraph("MENUGASKAN :", new Font(Font.FontFamily.TIMES_ROMAN, 14));
                    para8.setAlignment(Paragraph.ALIGN_CENTER);

                    Paragraph para9 = new Paragraph("Kepada :", new Font(Font.FontFamily.TIMES_ROMAN, 14));
                    para9.setSpacingAfter(8f);

                    document.add(para1);
                    document.add(para2);
                    document.add(para3);
                    document.add(para4);
                    document.add(para5);
                    document.add(para6);
                    document.add(para7);
                    document.add(para8);
                    document.add(para9);

                    PdfPTable table2 = new PdfPTable(3);

                    // Set table properties
                    float[] columnWidth = {0.75f, 0.1f, 2f};
                    table2.setWidths(columnWidth);

                    Font data_font = new Font(Font.FontFamily.TIMES_ROMAN, 14);
                    PdfPCell cellOne = new PdfPCell(new Phrase("Nama",data_font));
                    PdfPCell cellTwo = new PdfPCell(new Phrase(":",data_font));
                    PdfPCell cellThree = new PdfPCell(new Phrase(menugaskan,data_font));

                    cellOne.setBorder(Rectangle.NO_BORDER);
                    cellTwo.setBorder(Rectangle.NO_BORDER);
                    cellThree.setBorder(Rectangle.NO_BORDER);
                    cellOne.setPaddingLeft(15f);

                    PdfPCell cellFour = new PdfPCell(new Phrase("NIKKI",data_font));
                    PdfPCell cellFive = new PdfPCell(new Phrase(":",data_font));
                    PdfPCell cellSix = new PdfPCell(new Phrase(st.nikki,data_font));

                    cellFour.setBorder(Rectangle.NO_BORDER);
                    cellFive.setBorder(Rectangle.NO_BORDER);
                    cellSix.setBorder(Rectangle.NO_BORDER);
                    cellFour.setPaddingLeft(15f);

                    PdfPCell cellSeven = new PdfPCell(new Phrase("Jabatan",data_font));
                    PdfPCell cellEight = new PdfPCell(new Phrase(":",data_font));
                    PdfPCell cellNine = new PdfPCell(new Phrase(st.jabatan,data_font));

                    cellSeven.setBorder(Rectangle.NO_BORDER);
                    cellEight.setBorder(Rectangle.NO_BORDER);
                    cellNine.setBorder(Rectangle.NO_BORDER);
                    cellSeven.setPaddingLeft(15f);

                    PdfPCell cellTen = new PdfPCell(new Phrase("Tempat Tugas",data_font));
                    PdfPCell cellEleven = new PdfPCell(new Phrase(":",data_font));
                    PdfPCell cellTwelve = new PdfPCell(new Phrase("SMP Negeri 223 Jakarta",data_font));

                    cellTen.setBorder(Rectangle.NO_BORDER);
                    cellEleven.setBorder(Rectangle.NO_BORDER);
                    cellTwelve.setBorder(Rectangle.NO_BORDER);
                    cellTen.setPaddingLeft(15f);

                    // Add table cells
                    table2.addCell(cellOne);
                    table2.addCell(cellTwo);
                    table2.addCell(cellThree);
                    table2.addCell(cellFour);
                    table2.addCell(cellFive);
                    table2.addCell(cellSix);
                    table2.addCell(cellSeven);
                    table2.addCell(cellEight);
                    table2.addCell(cellNine);
                    table2.addCell(cellTen);
                    table2.addCell(cellEleven);
                    table2.addCell(cellTwelve);

                    document.add(table2);

                    Paragraph para10 = new Paragraph("Untuk :", new Font(Font.FontFamily.TIMES_ROMAN, 14));
                    para10.setSpacingAfter(8f);

                    document.add(para10);

                    PdfPTable table3 = new PdfPTable(2);

                    // Set table properties
                    table3.setWidthPercentage(100);
                    float[] columnWidth3 = {0.16f, 2f};
                    table3.setWidths(columnWidth3);

                    PdfPCell content2_cellOne = new PdfPCell(new Phrase("1.",data_font));
                    PdfPCell content2_cellTwo = new PdfPCell(new Phrase(keterangan1,data_font));

                    content2_cellOne.setPaddingLeft(20f);
                    content2_cellOne.setBorder(Rectangle.NO_BORDER);
                    content2_cellTwo.setBorder(Rectangle.NO_BORDER);
                    content2_cellTwo.setHorizontalAlignment(Element.ALIGN_JUSTIFIED);
                    content2_cellTwo.setPaddingBottom(8f);

                    table3.addCell(content2_cellOne);
                    table3.addCell(content2_cellTwo);

                    document.add(table3);

                    PdfPTable table4 = new PdfPTable(3);

                    // Set table properties
                    table4.setWidthPercentage(100);
                    float[] columnWidth4 = {1.9f, 0.2f, 4f};
                    table4.setWidths(columnWidth4);
    //                table4.setWidths(columnWidth);

                    PdfPCell row2_cellOne = new PdfPCell(new Phrase("Hari",data_font));
                    PdfPCell row2_cellTwo = new PdfPCell(new Phrase(":",data_font));
                    PdfPCell row2_cellThree = new PdfPCell(new Phrase(Fungsi.getDayName(dateChooser),data_font));

                    row2_cellOne.setBorder(Rectangle.NO_BORDER);
                    row2_cellTwo.setBorder(Rectangle.NO_BORDER);
                    row2_cellThree.setBorder(Rectangle.NO_BORDER);
                    row2_cellOne.setPaddingLeft(65f);

                    PdfPCell row2_cellFour = new PdfPCell(new Phrase("Tanggal",data_font));
                    PdfPCell row2_cellFive = new PdfPCell(new Phrase(":",data_font));
                    PdfPCell row2_cellSix = new PdfPCell(new Phrase(Fungsi.getDate(dateChooser),data_font));

                    row2_cellFour.setBorder(Rectangle.NO_BORDER);
                    row2_cellFive.setBorder(Rectangle.NO_BORDER);
                    row2_cellSix.setBorder(Rectangle.NO_BORDER);
                    row2_cellFour.setPaddingLeft(65f);

                    PdfPCell row2_cellSeven = new PdfPCell(new Phrase("Waktu",data_font));
                    PdfPCell row2_cellEight = new PdfPCell(new Phrase(":",data_font));
                    PdfPCell row2_cellNine = new PdfPCell(new Phrase(waktu_tugas,data_font));

                    row2_cellSeven.setBorder(Rectangle.NO_BORDER);
                    row2_cellEight.setBorder(Rectangle.NO_BORDER);
                    row2_cellNine.setBorder(Rectangle.NO_BORDER);
                    row2_cellSeven.setPaddingLeft(65f);

                    PdfPCell row2_cellTen = new PdfPCell(new Phrase("Tempat",data_font));
                    PdfPCell row2_cellEleven = new PdfPCell(new Phrase(":",data_font));
                    PdfPCell row2_cellTwelve = new PdfPCell(new Phrase(tempat_tugas,data_font));

                    row2_cellTen.setBorder(Rectangle.NO_BORDER);
                    row2_cellEleven.setBorder(Rectangle.NO_BORDER);
                    row2_cellTwelve.setBorder(Rectangle.NO_BORDER);
                    row2_cellTen.setPaddingLeft(65f);
                    row2_cellTwelve.setPaddingBottom(5f);

                    // Add table cells
                    table4.addCell(row2_cellOne);
                    table4.addCell(row2_cellTwo);
                    table4.addCell(row2_cellThree);
                    table4.addCell(row2_cellFour);
                    table4.addCell(row2_cellFive);
                    table4.addCell(row2_cellSix);
                    table4.addCell(row2_cellSeven);
                    table4.addCell(row2_cellEight);
                    table4.addCell(row2_cellNine);
                    table4.addCell(row2_cellTen);
                    table4.addCell(row2_cellEleven);
                    table4.addCell(row2_cellTwelve);

                    document.add(table4);

                    PdfPTable table5 = new PdfPTable(2);

                    // Set table properties
                    table5.setWidthPercentage(100);
                    table5.setWidths(columnWidth3);

                    PdfPCell keterangan2_cellOne = new PdfPCell(new Phrase("2.",data_font));
                    PdfPCell keterangan2_cellTwo = new PdfPCell(new Phrase(keterangan2,data_font));

                    keterangan2_cellOne.setPaddingLeft(20f);
                    keterangan2_cellOne.setBorder(Rectangle.NO_BORDER);
                    keterangan2_cellTwo.setBorder(Rectangle.NO_BORDER);
                    keterangan2_cellTwo.setHorizontalAlignment(Element.ALIGN_JUSTIFIED);
                    keterangan2_cellTwo.setPaddingBottom(8f);

                    table5.addCell(keterangan2_cellOne);
                    table5.addCell(keterangan2_cellTwo);

                    document.add(table5);

                    Paragraph para11 = new Paragraph("Surat Tugas ini dibuat untuk dilaksanakan dengan sebaik-baiknya dan penuh tanggung jawab.", boldFont);
                    para11.setAlignment(Element.ALIGN_JUSTIFIED);
                    para11.setFirstLineIndent(70f);
                    para11.setSpacingAfter(8f);

                    document.add(para11);

                    // Create the content table
                    PdfPTable contentTable3 = new PdfPTable(1);
                    contentTable3.setWidthPercentage(48);
                    contentTable3.setHorizontalAlignment(Element.ALIGN_RIGHT);

                    // Add the content rows to the table
                    PdfPCell cell_footer_tempat = new PdfPCell(new Phrase("Dikeluarkan di Jakarta", new Font(Font.FontFamily.TIMES_ROMAN,14)));
                    cell_footer_tempat.setBorder(PdfPCell.NO_BORDER);                
                    contentTable3.addCell(cell_footer_tempat);

                    PdfPCell cell_footer_tgl = new PdfPCell(new Phrase("pada tanggal "+Fungsi.getDate(dateChooser), new Font(Font.FontFamily.TIMES_ROMAN,14)));
                    cell_footer_tgl.setBorder(PdfPCell.NO_BORDER); 
                    cell_footer_tgl.setPaddingBottom(8f);
                    contentTable3.addCell(cell_footer_tgl);

                    PdfPCell cell_footer2 = new PdfPCell(new Phrase("Kepala SMP Negeri 223 Jakarta", new Font(Font.FontFamily.TIMES_ROMAN,14)));
                    cell_footer2.setBorder(PdfPCell.NO_BORDER);  
                    cell_footer2.setPaddingBottom(58f);
                    contentTable3.addCell(cell_footer2);

                    // Add the content rows to the table
                    PdfPCell cell_footer3 = new PdfPCell(new Phrase("OMAN NURYANI, M.Pd.", new Font(Font.FontFamily.TIMES_ROMAN,14)));
                    cell_footer3.setBorder(PdfPCell.NO_BORDER);                
                    contentTable3.addCell(cell_footer3);

                    PdfPCell cell_footer4 = new PdfPCell(new Phrase("NIP. 196807191997031003", new Font(Font.FontFamily.TIMES_ROMAN,14)));
                    cell_footer4.setBorder(PdfPCell.NO_BORDER);  
                    contentTable3.addCell(cell_footer4);

                    document.add(contentTable3);

                    document.close();
                    System.out.println("File created successfully");
                }
                File file1 = new File(filePath);

                JOptionPane.showMessageDialog(null, "Data berhasil dicetak", "Pesan", JOptionPane.INFORMATION_MESSAGE);
                // Open the URL in the default web browser
                Desktop.getDesktop().open(file1);
            } catch (Exception e) {
                    System.out.println(e);
            }
        }
    }//GEN-LAST:event_jButton6KeyPressed


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton jButton1;
    private javax.swing.JButton jButton2;
    private javax.swing.JButton jButton3;
    private javax.swing.JButton jButton4;
    private javax.swing.JButton jButton5;
    private javax.swing.JButton jButton6;
    private javax.swing.JComboBox<String> jComboBox1;
    private com.toedter.calendar.JDateChooser jDateChooser1;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel10;
    private javax.swing.JLabel jLabel11;
    private javax.swing.JLabel jLabel12;
    private javax.swing.JLabel jLabel13;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel7;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JScrollPane jScrollPane3;
    private javax.swing.JTable jTable1;
    private javax.swing.JTextArea jTextArea1;
    private javax.swing.JTextArea jTextArea2;
    private javax.swing.JTextField jTextField2;
    private javax.swing.JTextField jTextField3;
    private javax.swing.JTextField jTextField4;
    private javax.swing.JTextField jTextField6;
    private javax.swing.JTextField jTextField7;
    // End of variables declaration//GEN-END:variables

}
