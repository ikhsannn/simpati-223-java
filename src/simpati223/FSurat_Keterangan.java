/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package simpati223;

import com.itextpdf.text.Document;
import com.itextpdf.text.Element;
import com.itextpdf.text.Font;
import com.itextpdf.text.Image;
import com.itextpdf.text.PageSize;
import com.itextpdf.text.Paragraph;
import com.itextpdf.text.Phrase;
import com.itextpdf.text.Rectangle;
import com.itextpdf.text.pdf.PdfPCell;
import com.itextpdf.text.pdf.PdfPTable;
import com.itextpdf.text.pdf.PdfWriter;
import com.itextpdf.text.pdf.draw.LineSeparator;
import java.awt.Desktop;
import java.awt.event.ActionListener;
import java.awt.event.ItemEvent;
import java.awt.event.ItemListener;
import java.awt.event.KeyEvent;
import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.net.URL;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.SQLException;
import java.text.SimpleDateFormat;
import javax.swing.JComboBox;
import javax.swing.JFileChooser;
import javax.swing.JOptionPane;
import javax.swing.table.DefaultTableModel;
import javax.swing.table.TableColumn;

/**
 *
 * @author Maulana Yusuf
 */
public class FSurat_Keterangan extends javax.swing.JInternalFrame {

    /**
     * Creates new form Fsurat_keterangan
     */
    public FSurat_Keterangan() {
        initComponents();
        //letakkan fungsi tampil data disini
        TampilData();
        setBertandaTangan("");
        setKepada("");
        disableData();
        
        jComboBox1.addItemListener(new ItemListener() {
            public void itemStateChanged(ItemEvent e) {
                if (e.getStateChange() == ItemEvent.SELECTED) {
                    try {
                        Connection conn = Koneksi.getConnection();
                        Object selectedItem = jComboBox1.getSelectedItem();
                        if (selectedItem != null) {
                            java.sql.Statement stmt = conn.createStatement();
                            SQL = "select * from guru where nama = '"+selectedItem+"'";
                            java.sql.ResultSet res = stmt.executeQuery(SQL);

                            while (res.next()) {
                                tanda_tangan = res.getString("id");
                            }
                        }
                    } catch (SQLException es) {
                        System.out.println(es);
                        JOptionPane.showMessageDialog(null, "Ada kesalahan server, silahkan hubungi developer", "Pesan", JOptionPane.INFORMATION_MESSAGE);
                    }
                }
            }
        });
        
        jComboBox2.addItemListener(new ItemListener() {
            public void itemStateChanged(ItemEvent e) {
                if (e.getStateChange() == ItemEvent.SELECTED) {
                    try {
                        Connection conn = Koneksi.getConnection();
                        Object selectedItem = jComboBox2.getSelectedItem();
                        if (selectedItem != null) {
                            java.sql.Statement stmt = conn.createStatement();
                            SQL = "select * from siswa where nama = '"+selectedItem+"'";
                            java.sql.ResultSet res = stmt.executeQuery(SQL);

                            while (res.next()) {
                                kepada = res.getString("id");
                            }
                        }
                    } catch (SQLException es) {
                        System.out.println(es);
                        JOptionPane.showMessageDialog(null, "Ada kesalahan server, silahkan hubungi developer", "Pesan", JOptionPane.INFORMATION_MESSAGE);
                    }
                }
            }
        });
     }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jPanel1 = new javax.swing.JPanel();
        jLabel1 = new javax.swing.JLabel();
        jTextField2 = new javax.swing.JTextField();
        jPanel3 = new javax.swing.JPanel();
        jButton2 = new javax.swing.JButton();
        jButton3 = new javax.swing.JButton();
        jButton4 = new javax.swing.JButton();
        jButton5 = new javax.swing.JButton();
        jButton1 = new javax.swing.JButton();
        jPanel7 = new javax.swing.JPanel();
        jScrollPane1 = new javax.swing.JScrollPane();
        jTable1 = new javax.swing.JTable();
        jPanel2 = new javax.swing.JPanel();
        jLabel8 = new javax.swing.JLabel();
        jTextField3 = new javax.swing.JTextField();
        jLabel9 = new javax.swing.JLabel();
        jLabel10 = new javax.swing.JLabel();
        jLabel12 = new javax.swing.JLabel();
        jDateChooser1 = new com.toedter.calendar.JDateChooser();
        jScrollPane2 = new javax.swing.JScrollPane();
        jTextArea1 = new javax.swing.JTextArea();
        jLabel2 = new javax.swing.JLabel();
        jComboBox1 = new javax.swing.JComboBox<>();
        jComboBox2 = new javax.swing.JComboBox<>();
        jLabel3 = new javax.swing.JLabel();
        jButton6 = new javax.swing.JButton();

        setPreferredSize(new java.awt.Dimension(700, 600));

        jPanel1.setBackground(new java.awt.Color(255, 255, 255));

        jLabel1.setFont(new java.awt.Font("Tahoma", 1, 18)); // NOI18N
        jLabel1.setText("Surat Keterangan");

        jTextField2.setPreferredSize(new java.awt.Dimension(60, 20));

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jTextField2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(jLabel1)
                .addGap(18, 18, 18))
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addComponent(jTextField2, javax.swing.GroupLayout.DEFAULT_SIZE, 24, Short.MAX_VALUE)
                        .addGap(2, 2, 2))
                    .addComponent(jLabel1, javax.swing.GroupLayout.Alignment.LEADING))
                .addGap(13, 13, 13))
        );

        jPanel3.setBackground(new java.awt.Color(255, 255, 255));
        jPanel3.setForeground(new java.awt.Color(255, 255, 255));

        jButton2.setBackground(new java.awt.Color(51, 0, 204));
        jButton2.setFont(new java.awt.Font("Tahoma", 1, 20)); // NOI18N
        jButton2.setForeground(new java.awt.Color(255, 255, 255));
        jButton2.setText("Simpan");
        jButton2.setPreferredSize(new java.awt.Dimension(120, 33));
        jButton2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton2ActionPerformed(evt);
            }
        });
        jButton2.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jButton2KeyPressed(evt);
            }
        });

        jButton3.setBackground(new java.awt.Color(255, 204, 0));
        jButton3.setFont(new java.awt.Font("Tahoma", 1, 20)); // NOI18N
        jButton3.setForeground(new java.awt.Color(255, 255, 255));
        jButton3.setText("Ubah");
        jButton3.setPreferredSize(new java.awt.Dimension(120, 33));
        jButton3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton3ActionPerformed(evt);
            }
        });
        jButton3.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jButton3KeyPressed(evt);
            }
        });

        jButton4.setBackground(new java.awt.Color(204, 0, 0));
        jButton4.setFont(new java.awt.Font("Tahoma", 1, 20)); // NOI18N
        jButton4.setForeground(new java.awt.Color(255, 255, 255));
        jButton4.setText("Hapus");
        jButton4.setPreferredSize(new java.awt.Dimension(120, 33));
        jButton4.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton4ActionPerformed(evt);
            }
        });
        jButton4.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jButton4KeyPressed(evt);
            }
        });

        jButton5.setBackground(new java.awt.Color(0, 153, 0));
        jButton5.setFont(new java.awt.Font("Tahoma", 1, 20)); // NOI18N
        jButton5.setForeground(new java.awt.Color(255, 255, 255));
        jButton5.setText("Batal");
        jButton5.setPreferredSize(new java.awt.Dimension(120, 33));
        jButton5.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton5ActionPerformed(evt);
            }
        });
        jButton5.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jButton5KeyPressed(evt);
            }
        });

        jButton1.setBackground(new java.awt.Color(0, 153, 153));
        jButton1.setFont(new java.awt.Font("Tahoma", 1, 18)); // NOI18N
        jButton1.setForeground(new java.awt.Color(255, 255, 255));
        jButton1.setText("New");
        jButton1.setMaximumSize(new java.awt.Dimension(109, 31));
        jButton1.setPreferredSize(new java.awt.Dimension(100, 33));
        jButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton1ActionPerformed(evt);
            }
        });
        jButton1.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jButton1KeyPressed(evt);
            }
        });

        javax.swing.GroupLayout jPanel3Layout = new javax.swing.GroupLayout(jPanel3);
        jPanel3.setLayout(jPanel3Layout);
        jPanel3Layout.setHorizontalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addGap(85, 85, 85)
                .addComponent(jButton1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jButton2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jButton3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jButton4, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jButton5, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );
        jPanel3Layout.setVerticalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addGap(10, 10, 10)
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jButton2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jButton3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jButton4, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jButton5, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jButton1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(10, 10, 10))
        );

        jPanel7.setBackground(new java.awt.Color(255, 255, 255));

        jTable1.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "No Surat", "Tanggal Surat", "Yang bertanda tangan", "Menerangkan kepada"
            }
        ));
        jTable1.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jTable1MouseClicked(evt);
            }
        });
        jScrollPane1.setViewportView(jTable1);

        javax.swing.GroupLayout jPanel7Layout = new javax.swing.GroupLayout(jPanel7);
        jPanel7.setLayout(jPanel7Layout);
        jPanel7Layout.setHorizontalGroup(
            jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel7Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jScrollPane1)
                .addContainerGap())
        );
        jPanel7Layout.setVerticalGroup(
            jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel7Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jScrollPane1, javax.swing.GroupLayout.DEFAULT_SIZE, 217, Short.MAX_VALUE)
                .addGap(10, 10, 10))
        );

        jPanel2.setBackground(new java.awt.Color(255, 255, 255));
        jPanel2.setToolTipText("");
        jPanel2.setName(""); // NOI18N

        jLabel8.setText("No Surat");
        jLabel8.setPreferredSize(new java.awt.Dimension(120, 14));

        jTextField3.setPreferredSize(new java.awt.Dimension(145, 25));

        jLabel9.setText("Yang bertanda tangan");
        jLabel9.setPreferredSize(new java.awt.Dimension(130, 14));

        jLabel10.setText("Menerangkan kepada");
        jLabel10.setPreferredSize(new java.awt.Dimension(130, 14));

        jLabel12.setText("Tgl Surat");
        jLabel12.setPreferredSize(new java.awt.Dimension(108, 14));

        jDateChooser1.setPreferredSize(new java.awt.Dimension(155, 25));
        jDateChooser1.addPropertyChangeListener(new java.beans.PropertyChangeListener() {
            public void propertyChange(java.beans.PropertyChangeEvent evt) {
                jDateChooser1PropertyChange(evt);
            }
        });

        jScrollPane2.setPreferredSize(new java.awt.Dimension(155, 60));

        jTextArea1.setColumns(20);
        jTextArea1.setRows(5);
        jTextArea1.setPreferredSize(new java.awt.Dimension(145, 30));
        jScrollPane2.setViewportView(jTextArea1);

        jLabel2.setText("Keterangan");
        jLabel2.setPreferredSize(new java.awt.Dimension(108, 14));

        jComboBox1.setPreferredSize(new java.awt.Dimension(145, 25));
        jComboBox1.addPropertyChangeListener(new java.beans.PropertyChangeListener() {
            public void propertyChange(java.beans.PropertyChangeEvent evt) {
                jComboBox1PropertyChange(evt);
            }
        });

        jComboBox2.setPreferredSize(new java.awt.Dimension(145, 25));
        jComboBox2.addPropertyChangeListener(new java.beans.PropertyChangeListener() {
            public void propertyChange(java.beans.PropertyChangeEvent evt) {
                jComboBox2PropertyChange(evt);
            }
        });

        jLabel3.setText("File");
        jLabel3.setPreferredSize(new java.awt.Dimension(108, 14));

        jButton6.setText("Cetak");
        jButton6.setPreferredSize(new java.awt.Dimension(145, 25));
        jButton6.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton6ActionPerformed(evt);
            }
        });
        jButton6.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jButton6KeyPressed(evt);
            }
        });

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addGap(89, 89, 89)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel8, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel9, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jComboBox1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jTextField3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel10, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel12, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jDateChooser1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jComboBox2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))))
                .addGap(55, 55, 55)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jScrollPane2, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jButton6, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addGap(20, 20, 20)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel2Layout.createSequentialGroup()
                        .addComponent(jScrollPane2, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addGap(15, 15, 15)
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jButton6, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel8, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jTextField3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(15, 15, 15)
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel9, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jComboBox1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(15, 15, 15)
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel10, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jComboBox2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(15, 15, 15)
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel12, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jDateChooser1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))))
        );

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
            .addComponent(jPanel3, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
            .addComponent(jPanel7, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
            .addComponent(jPanel2, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(10, 10, 10)
                .addComponent(jPanel2, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGap(10, 10, 10)
                .addComponent(jPanel3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(10, 10, 10)
                .addComponent(jPanel7, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(10, 10, 10))
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private DefaultTableModel DftTblModel_Surat_Keterangan;
    private String SQL;
    public String dateChooser,tanda_tangan,kepada,nip,nrk,pangkat,golongan,jabatan,tempat,tgl_lahir,nipd,nisn;
    
    private void setBertandaTangan(String id_guru){
        Connection conn = Koneksi.getConnection();
        if (id_guru.isEmpty()) {
            try {
                java.sql.Statement stmt = conn.createStatement();
                SQL = "select * from guru ";
                java.sql.ResultSet res = stmt.executeQuery(SQL);

                while (res.next()) {                
                    jComboBox1.addItem(res.getString("nama"));
                }

                res.last();
                int jumlahdata = res.getRow();
                res.first();

            } catch (SQLException e) {
                System.out.println(e);
                JOptionPane.showMessageDialog(null, "Ada kesalahan server, silahkan hubungi developer", "Pesan", JOptionPane.INFORMATION_MESSAGE);
            }
        } else {
            try {
                java.sql.Statement stmt = conn.createStatement();
                SQL = "select * from guru where nama = '"+id_guru+"'";
                java.sql.ResultSet res = stmt.executeQuery(SQL);

                while (res.next()) {
                    tanda_tangan = res.getString("id");
                    nip = res.getString("nip");
                    nrk = res.getString("nrk");
                    pangkat = res.getString("pangkat");
                    golongan = res.getString("golongan");
                    jabatan = res.getString("jabatan");
                }
            } catch (SQLException es) {
                System.out.println(es);
                JOptionPane.showMessageDialog(null, "Ada kesalahan server, silahkan hubungi developer", "Pesan", JOptionPane.INFORMATION_MESSAGE);
            }
        } 
    }
    
//    private String getDatField(String tabel, String column){
//        Connection conn = Koneksi.getConnection();
//        String field = "";
//        try {
//            java.sql.Statement stmt = conn.createStatement();
//            if (tabel.equals("guru")) {
//
//            } else {
//                
//            }
//        } catch (Exception e) {
//            
//        }
//        return field;
//    }
    
    private void setKepada(String id_siswa){
        Connection conn = Koneksi.getConnection();
        if (id_siswa.isEmpty()) {
            try {
                java.sql.Statement stmt = conn.createStatement();
                SQL = "select * from siswa ";
                java.sql.ResultSet res = stmt.executeQuery(SQL);

                while (res.next()) {                
                    jComboBox2.addItem(res.getString("nama"));
                }

                res.last();
                int jumlahdata = res.getRow();
                res.first();

            } catch (SQLException e) {
                System.out.println(e);
                JOptionPane.showMessageDialog(null, "Ada kesalahan server, silahkan hubungi developer", "Pesan", JOptionPane.INFORMATION_MESSAGE);
            }  
        } else {
            try {
                java.sql.Statement stmt = conn.createStatement();
                SQL = "select * from siswa where nama = '"+id_siswa+"'";
                java.sql.ResultSet res = stmt.executeQuery(SQL);

                while (res.next()) {
                    kepada = res.getString("id");
                    tempat = res.getString("tempat_lahir");
                    tgl_lahir = res.getString("tgl_lahir");
                    nipd = res.getString("nipd");
                    nisn = res.getString("nisn");
                }
            } catch (SQLException es) {
                System.out.println(es);
                JOptionPane.showMessageDialog(null, "Ada kesalahan server, silahkan hubungi developer", "Pesan", JOptionPane.INFORMATION_MESSAGE);
            }
        }
    }
    
    private void setTanggal(){
           Connection conn = Koneksi.getConnection();
        try {
        
            java.sql.Statement stmt = conn.createStatement();
            SQL = "select * from surat_keterangan where id like '%" +jTextField2.getText()+"'";
            java.sql.ResultSet res = stmt.executeQuery(SQL);
            while (res.next())
            {
                jDateChooser1.setDate(res.getDate("tgl_surat", null));
            }
        }catch (Exception e){
            System.out.println(e);
            JOptionPane.showMessageDialog(null, "Ada kesalahan server, silahkan hubungi developer", "Pesan", JOptionPane.INFORMATION_MESSAGE);
        }
    }
    
    public static void hideJTableColumn(TableColumn tc) {
       lockJTableColumnWidth(tc, 0);
    }

    public static void lockJTableColumnWidth(TableColumn tc, int pixels) {
       if (tc != null) {
           tc.setMinWidth(pixels);
           tc.setMaxWidth(pixels);
           tc.setPreferredWidth(pixels);
           tc.setResizable(false);
       }
    }
   
    public void TampilData() {
        DftTblModel_Surat_Keterangan = new DefaultTableModel();
        DftTblModel_Surat_Keterangan.addColumn("id");
        DftTblModel_Surat_Keterangan.addColumn("No Surat");
        DftTblModel_Surat_Keterangan.addColumn("Tanggal Surat");
        DftTblModel_Surat_Keterangan.addColumn("Yang bertanda tangan");
        DftTblModel_Surat_Keterangan.addColumn("Menerangkan Kepada");
        DftTblModel_Surat_Keterangan.addColumn("Keterangan");
        DftTblModel_Surat_Keterangan.addColumn("id_guru");
        DftTblModel_Surat_Keterangan.addColumn("id_siswa");
        jTable1.setModel(DftTblModel_Surat_Keterangan);

        Connection conn = Koneksi.getConnection();
        try {
            java.sql.Statement stmt = conn.createStatement();
            SQL = "SELECT a.*, b.nama as nama_guru, c.nama as nama_siswa FROM surat_keterangan a " +
                  "LEFT JOIN guru b ON a.id_guru = b.id "+
                  "LEFT JOIN siswa c ON a.id_siswa = c.id";
            java.sql.ResultSet res = stmt.executeQuery(SQL);
            while (res.next()) {
               DftTblModel_Surat_Keterangan.addRow(new Object[]{
                    res.getString("id"),
                    res.getString("nomor_surat"), //tampilin ke layar
                    res.getString("tgl_surat"),//tampilin ke layar
                    res.getString("nama_guru"), //tampilin ke layar
                    res.getString("nama_siswa"),//tampilin ke layar
                    res.getString("keterangan"),
                    res.getString("id_guru"),
                    res.getString("id_siswa")
                });
            }
        hideJTableColumn(jTable1.getColumnModel().getColumn(0));
        hideJTableColumn(jTable1.getColumnModel().getColumn(5));
        hideJTableColumn(jTable1.getColumnModel().getColumn(6));
        hideJTableColumn(jTable1.getColumnModel().getColumn(7));
        } catch (SQLException e) {
            System.out.println(e);
            JOptionPane.showMessageDialog(null, "Ada kesalahan server, silahkan hubungi developer", "Pesan", JOptionPane.INFORMATION_MESSAGE);
        }
    }
    
    public void disableData(){
        jTextField2.setVisible(false);
        jButton2.setEnabled(false);
        jButton3.setEnabled(false);
        jButton4.setEnabled(false);
        jButton6.setEnabled(false);
        //atur dibawahnya
        jTextField3.setEnabled(false);
        jComboBox1.setEnabled(false);
        jComboBox2.setEnabled(false);
        jDateChooser1.setEnabled(false);
        jTextArea1.setEnabled(false);
    }
//    
    public void enableData(){
        jButton2.setEnabled(true);
        jButton3.setEnabled(false);
        jButton4.setEnabled(false);
        jButton6.setEnabled(false);
        //atur dibawahnya
        jTextField3.setEnabled(true);
        jComboBox1.setEnabled(true);
        jComboBox2.setEnabled(true);
        jDateChooser1.setEnabled(true);
        jTextArea1.setEnabled(true);
    }
//    
    public void enableDataEdit(){
        jButton2.setEnabled(false);
        jButton3.setEnabled(true);
        jButton4.setEnabled(true);
        jButton6.setEnabled(true);
        //atur dibawahnya
        jTextField3.setEnabled(true);
        jComboBox1.setEnabled(true);
        jComboBox2.setEnabled(true);
        jDateChooser1.setEnabled(true);
        jTextArea1.setEnabled(true);
    }
//    
    public void clearData(){
        jTextField2.setText("");
        jTextField3.setText("");
        jComboBox1.setSelectedItem(null);
        jComboBox2.setSelectedItem(null);
        jDateChooser1.setDate(null);
        jTextArea1.setText("");
    }
//    
 public void getData() {
        jTextField2.setText(jTable1.getValueAt(jTable1.getSelectedRow(), 0).toString());
        //atur dibawahnya 
        jTextField3.setText(jTable1.getValueAt(jTable1.getSelectedRow(), 1).toString());
        setTanggal();
        Object obj_guru = jTable1.getValueAt(jTable1.getSelectedRow(), 3);
        jComboBox1.setSelectedItem(obj_guru);
        setBertandaTangan((String) obj_guru);
        Object obj_siswa = jTable1.getValueAt(jTable1.getSelectedRow(), 4);
        jComboBox2.setSelectedItem(obj_siswa);
        setKepada((String) obj_siswa);
        jTextArea1.setText(jTable1.getValueAt(jTable1.getSelectedRow(), 5).toString());
        jButton2.setEnabled(false);
    }

//    
  public void simpanData() {
    try {
        Connection conn = Koneksi.getConnection();
        PreparedStatement stmt = conn.prepareStatement("insert into surat_keterangan(nomor_surat, tgl_surat, id_guru, id_siswa,keterangan)"
                + "values(?,?,?,?,?)");
        stmt.setString(1, jTextField3.getText());
        stmt.setObject(2, jDateChooser1.getDate());
        stmt.setString(3, tanda_tangan);
        stmt.setString(4, kepada);
        stmt.setString(5, jTextArea1.getText());
        stmt.executeUpdate();
        JOptionPane.showMessageDialog(null, "Data berhasil disimpan", "Pesan", JOptionPane.INFORMATION_MESSAGE);
        TampilData();
        clearData();
    } catch (SQLException e) {
        System.out.println(e);
        JOptionPane.showMessageDialog(null, "Ada kesalahan server, silahkan hubungi developer", "Pesan", JOptionPane.INFORMATION_MESSAGE);
    }
}

    public void editData(){
        try {
            Connection conn = Koneksi.getConnection();
            Object id = jTable1.getValueAt(jTable1.getSelectedRow(), 0);
            PreparedStatement stmt = conn.prepareStatement("UPDATE surat_keterangan SET nomor_surat='" + jTextField3.getText() + 
                    "'," + "id_guru ='" + tanda_tangan +"',id_siswa ='" +kepada+
                    "'," + "tgl_surat ='" +dateChooser+"',keterangan ='" +jTextArea1.getText()+
                    "' WHERE id='" +id+"'");
            stmt.executeUpdate();
            JOptionPane.showMessageDialog(null, "Data berhasil diubah", "Pesan", JOptionPane.INFORMATION_MESSAGE);
            TampilData();
            clearData();
        } catch (SQLException e) {
            System.out.println(e);
            JOptionPane.showMessageDialog(null, "Data gagal di edit", "Pesan", JOptionPane.INFORMATION_MESSAGE);
        }
    }
    
    public void deleteData(){
        Connection conn = Koneksi.getConnection();
        int confirm = JOptionPane.showConfirmDialog(null, "Apakah anda yakin ingin menghapus data tersebut?", 
                "Konfirmasi", JOptionPane.YES_NO_OPTION, JOptionPane.QUESTION_MESSAGE);
        if (confirm == 0) {
            try {
                Object id = jTable1.getValueAt(jTable1.getSelectedRow(), 0);
                java.sql.PreparedStatement stmt = conn.prepareStatement("delete from surat_keterangan "
                        + "where id ='" + id + "'");
                stmt.executeUpdate();
                JOptionPane.showMessageDialog(null, "Data berhasil dihapus", "Pesan", 
                        JOptionPane.INFORMATION_MESSAGE);
                TampilData();
                clearData();
            } catch (SQLException e) {
                System.out.println(e);
                JOptionPane.showMessageDialog(null, "Data gagal di hapus" + e.getMessage(), "Pesan", 
                        JOptionPane.ERROR_MESSAGE);
            }
        }
    }
    
    private void jButton2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton2ActionPerformed
        // TODO add your handling code here:
        simpanData();
    }//GEN-LAST:event_jButton2ActionPerformed

    private void jButton2KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jButton2KeyPressed
        // TODO add your handling code here:
        if(evt.getKeyCode() == java.awt.event.KeyEvent.VK_ENTER){
            simpanData();
        }
    }//GEN-LAST:event_jButton2KeyPressed

    private void jButton3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton3ActionPerformed
        // TODO add your handling code here:
        String id = jTextField2.getText();
        if (id.isEmpty()) {
            JOptionPane.showMessageDialog(null, "Silahkan pilih data terlebih dahulu atau klik tombol new", "Pesan", JOptionPane.INFORMATION_MESSAGE);
        } else {
            editData();
        }
    }//GEN-LAST:event_jButton3ActionPerformed

    private void jButton3KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jButton3KeyPressed
        // TODO add your handling code here:
        if(evt.getKeyCode() == java.awt.event.KeyEvent.VK_ENTER){
            String id = jTextField2.getText();
            if (id.isEmpty()) {
                JOptionPane.showMessageDialog(null, "Silahkan pilih data terlebih dahulu atau klik tombol new", "Pesan", JOptionPane.INFORMATION_MESSAGE);
            } else {
                editData();
            }
        }
    }//GEN-LAST:event_jButton3KeyPressed

    private void jButton4ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton4ActionPerformed
        // TODO add your handling code here:
        String id = jTextField2.getText();
        if (id.isEmpty()) {
            JOptionPane.showMessageDialog(null, "Silahkan pilih data terlebih dahulu atau klik tombol new", "Pesan", JOptionPane.INFORMATION_MESSAGE);
        } else {
            deleteData();
        }
    }//GEN-LAST:event_jButton4ActionPerformed

    private void jButton4KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jButton4KeyPressed
        // TODO add your handling code here:
        if(evt.getKeyCode() == java.awt.event.KeyEvent.VK_ENTER){
            String id = jTextField2.getText();
            if (id.isEmpty()) {
                JOptionPane.showMessageDialog(null, "Silahkan pilih data terlebih dahulu atau klik tombol new", "Pesan", JOptionPane.INFORMATION_MESSAGE);
            } else {
                deleteData();
            }
        }
    }//GEN-LAST:event_jButton4KeyPressed

    private void jButton5ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton5ActionPerformed
        // TODO add your handling code here:
        dispose();
    }//GEN-LAST:event_jButton5ActionPerformed

    private void jButton5KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jButton5KeyPressed
        // TODO add your handling code here:
        if(evt.getKeyCode()==KeyEvent.VK_ENTER){
            dispose();
        }
    }//GEN-LAST:event_jButton5KeyPressed

    private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton1ActionPerformed
        // TODO add your handling code here:
        enableData();
        clearData();
    }//GEN-LAST:event_jButton1ActionPerformed

    private void jButton1KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jButton1KeyPressed
        // TODO add your handling code here:
        if(evt.getKeyCode()==KeyEvent.VK_ENTER){
            enableData();
            clearData();
        }
    }//GEN-LAST:event_jButton1KeyPressed

    private void jTable1MouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jTable1MouseClicked
        // TODO add your handling code here:
        getData();
        enableDataEdit();
    }//GEN-LAST:event_jTable1MouseClicked

    private void jDateChooser1PropertyChange(java.beans.PropertyChangeEvent evt) {//GEN-FIRST:event_jDateChooser1PropertyChange
        // TODO add your handling code here:
        try {
            if (jDateChooser1.getDate()!= null) {
                String tanggal = "yyyy-MM-dd";
                SimpleDateFormat format = new SimpleDateFormat (tanggal);
                dateChooser = String.valueOf(format.format(jDateChooser1.getDate()));
            }
        } catch (Exception e) {
            System.out.println(e);
            JOptionPane.showMessageDialog(null, "Ada kesalahan server, silahkan hubungi developer", "Pesan", JOptionPane.INFORMATION_MESSAGE);
        }
    }//GEN-LAST:event_jDateChooser1PropertyChange

    private void jComboBox1PropertyChange(java.beans.PropertyChangeEvent evt) {//GEN-FIRST:event_jComboBox1PropertyChange
        // TODO add your handling code here:
    }//GEN-LAST:event_jComboBox1PropertyChange

    private void jComboBox2PropertyChange(java.beans.PropertyChangeEvent evt) {//GEN-FIRST:event_jComboBox2PropertyChange
        // TODO add your handling code here:
    }//GEN-LAST:event_jComboBox2PropertyChange

    private void jButton6ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton6ActionPerformed
        // TODO add your handling code here:
        Connection conn = Koneksi.getConnection();
        try {
            FSurat_Keterangan sk = new FSurat_Keterangan();
            String no_surat = jTextField3.getText();
            String bertanda_tangan = jComboBox1.getItemAt(jComboBox1.getSelectedIndex());
            String menerangkan = jComboBox2.getItemAt(jComboBox2.getSelectedIndex());
            sk.setBertandaTangan(bertanda_tangan);
            sk.setKepada(menerangkan);
            Object tgl_surat = jDateChooser1.getDate();
            String keterangan = jTextArea1.getText();
            String folderPath = "C:\\simpati223";
            String filePath = "C:\\simpati223\\surat_keterangan_"+menerangkan+".pdf";

            // Check if folder exists, create if it doesn't
            File folder = new File(folderPath);
            if (!folder.exists()) {
                boolean created = folder.mkdirs();
                if (created) {
                    System.out.println("Folder created successfully");
                } else {
                    System.out.println("Failed to create folder");
                }
            } else {
                System.out.println("Folder already exists");
            }

            // Check if file exists, create if it doesn't
            File file = new File(filePath);
            if (!file.exists()) {
                try {
                    boolean created = file.createNewFile();
                    if (created) {
                        //after created file, then we can create a content from pdf
                        //50 pertama itu left
                        //50 kedua itu right
                        Document document = new Document(PageSize.A4, 45, 45, 5, 50);
                        PdfWriter.getInstance(document, new FileOutputStream(filePath));

                        document.open();

                        // Create the header table
                        PdfPTable headerTable = new PdfPTable(2);
                        headerTable.setWidthPercentage(100);
                        headerTable.setWidths(new float[]{13, 87});

                        // Create the image cell
                        PdfPCell imageCell = new PdfPCell();
                        Image logo = Image.getInstance(getClass().getResource("/logo-jakarta-raya.jpeg"));
                        logo.scaleToFit(87, 125);
                        logo.setSpacingBefore(10f);
                        imageCell.addElement(logo);
                        imageCell.setRowspan(7);
                        imageCell.setBorder(PdfPCell.NO_BORDER);
                        headerTable.addCell(imageCell);

                        // Create the text cell
                        PdfPCell textCell = new PdfPCell();
                        Paragraph paragraph1 = new Paragraph("PEMERINTAH PROVINSI DAERAH KHUSUS IBUKOTA JAKARTA\nDINAS PENDIDIKAN", new Font(Font.FontFamily.HELVETICA, 11));
                        paragraph1.setAlignment(Paragraph.ALIGN_CENTER);
                        Paragraph paragraph2 = new Paragraph("SMP NEGERI 223 JAKARTA", new Font(Font.FontFamily.HELVETICA, 12, Font.BOLD));
                        paragraph2.setAlignment(Paragraph.ALIGN_CENTER);
                        Paragraph paragraph3 = new Paragraph("Jl. Surilang No. 6 Kel. Gedong Kec. Pasar Rebo\nTelepon (021) 8403316 Faximile (021) 8403316", new Font(Font.FontFamily.HELVETICA,11));
                        paragraph3.setAlignment(Paragraph.ALIGN_CENTER);
                        Paragraph paragraph4 = new Paragraph("E-mail: smpn223jktm@gmail.com\nJAKARTA", new Font(Font.FontFamily.HELVETICA, 11));
                        paragraph4.setAlignment(Paragraph.ALIGN_CENTER);
                        Paragraph paragraph5 = new Paragraph("Kode Pos : 13760", new Font(Font.FontFamily.HELVETICA, 11));
                        paragraph5.setAlignment(Paragraph.ALIGN_RIGHT);
                        Paragraph paragraph6 = new Paragraph(" ", new Font(Font.FontFamily.HELVETICA, 3));

                        textCell.addElement(paragraph1);
                        textCell.addElement(paragraph2);
                        textCell.addElement(paragraph3);
                        textCell.addElement(paragraph4);
                        textCell.addElement(paragraph5);
                        textCell.addElement(paragraph6);
                        textCell.setBorder(PdfPCell.NO_BORDER);
                        headerTable.addCell(textCell);

                        // Add the header table to the document
                        document.add(headerTable);

                        // Add a horizontal line
                        LineSeparator lineSeparator = new LineSeparator();
                        lineSeparator.setLineWidth(2);
                        document.add(lineSeparator);

                        // Create the content table
                        PdfPTable contentTable = new PdfPTable(1);
                        contentTable.setWidthPercentage(100);

                        // Add the content rows to the table
                        PdfPCell cell1 = new PdfPCell(new Phrase("SURAT KETERANGAN", new Font(Font.FontFamily.HELVETICA,15, Font.BOLD)));
                        cell1.setBorder(PdfPCell.NO_BORDER);
                        cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell1.setPaddingTop(20f);
                        cell1.setPaddingBottom(7f);
                        contentTable.addCell(cell1);

                        PdfPCell cell2 = new PdfPCell(new Phrase("NOMOR : "+no_surat, new Font(Font.FontFamily.HELVETICA,13)));
                        cell2.setBorder(PdfPCell.NO_BORDER);
                        cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell2.setPaddingBottom(35f);
                        contentTable.addCell(cell2);

                        PdfPCell cell3 = new PdfPCell(new Phrase("Yang bertanda tangan dibawah ini : ", new Font(Font.FontFamily.HELVETICA, 11)));
                        cell3.setBorder(PdfPCell.NO_BORDER);
                        cell3.setHorizontalAlignment(Element.ALIGN_LEFT);
                        cell3.setPaddingBottom(20f);
                        cell3.setPaddingLeft(30f);
                        contentTable.addCell(cell3);

                        // Add the content table to the document
                        document.add(contentTable);

                        PdfPTable table = new PdfPTable(3);

                        // Set table properties
                        table.setWidthPercentage(62);
                        table.setHorizontalAlignment(Element.ALIGN_LEFT);
                        float[] columnWidths = {1.7f, 0.1f, 2f};
                        table.setWidths(columnWidths);

                        PdfPCell cellOne = new PdfPCell(new Phrase("Nama"));
                        PdfPCell cellTwo = new PdfPCell(new Phrase(":"));
                        PdfPCell cellThree = new PdfPCell(new Phrase(bertanda_tangan));

                        cellOne.setBorder(Rectangle.NO_BORDER);
                        cellTwo.setBorder(Rectangle.NO_BORDER);
                        cellThree.setBorder(Rectangle.NO_BORDER);

                        PdfPCell cellFour = new PdfPCell(new Phrase("NIP / NRK"));
                        PdfPCell cellFive = new PdfPCell(new Phrase(":"));
                        PdfPCell cellSix = new PdfPCell(new Phrase(sk.nip+"/"+sk.nrk));

                        cellFour.setBorder(Rectangle.NO_BORDER);
                        cellFive.setBorder(Rectangle.NO_BORDER);
                        cellSix.setBorder(Rectangle.NO_BORDER);

                        PdfPCell cellSeven = new PdfPCell(new Phrase("Pangkat / Golongan"));
                        PdfPCell cellEight = new PdfPCell(new Phrase(":"));
                        PdfPCell cellNine = new PdfPCell(new Phrase(sk.pangkat+"/ ("+sk.golongan+")"));

                        cellSeven.setBorder(Rectangle.NO_BORDER);
                        cellEight.setBorder(Rectangle.NO_BORDER);
                        cellNine.setBorder(Rectangle.NO_BORDER);

                        PdfPCell cellTen = new PdfPCell(new Phrase("Jabatan"));
                        PdfPCell cellEleven = new PdfPCell(new Phrase(":"));
                        PdfPCell cellTwelve =  new PdfPCell(new Phrase(sk.jabatan));

                        cellTen.setBorder(Rectangle.NO_BORDER);
                        cellEleven.setBorder(Rectangle.NO_BORDER);
                        cellTwelve.setBorder(Rectangle.NO_BORDER);
                        cellTwelve.setPaddingBottom(20f);

                        // Add table cells
                        table.addCell(cellOne);
                        table.addCell(cellTwo);
                        table.addCell(cellThree);
                        table.addCell(cellFour);
                        table.addCell(cellFive);
                        table.addCell(cellSix);
                        table.addCell(cellSeven);
                        table.addCell(cellEight);
                        table.addCell(cellNine);
                        table.addCell(cellTen);
                        table.addCell(cellEleven);
                        table.addCell(cellTwelve);

                        // Add the table to the document
                        document.add(table);

                        // Create the content table
                        PdfPTable contentTable2 = new PdfPTable(1);
                        contentTable2.setWidthPercentage(100);

                        PdfPCell cell4 = new PdfPCell(new Phrase("menerangkan dengan sesungguhnya bahwa : ", new Font(Font.FontFamily.HELVETICA, 11)));
                        cell4.setBorder(PdfPCell.NO_BORDER);
                        cell4.setHorizontalAlignment(Element.ALIGN_LEFT);
                        cell4.setPaddingBottom(20f);
                        cell4.setPaddingLeft(30f);
                        contentTable2.addCell(cell4);

                        // Add the contentTable2 to the document
                        document.add(contentTable2);

                        PdfPTable table2 = new PdfPTable(3);

                        // Set table properties
                        table2.setWidthPercentage(62);
                        table2.setHorizontalAlignment(Element.ALIGN_LEFT);
                        float[] columnWidths2 = {1.7f, 0.1f, 2f};
                        table2.setWidths(columnWidths2);

                        PdfPCell cell2_One = new PdfPCell(new Phrase("Nama"));
                        PdfPCell cell2_Two = new PdfPCell(new Phrase(":"));
                        PdfPCell cell2_Three = new PdfPCell(new Phrase(menerangkan));

                        cell2_One.setBorder(Rectangle.NO_BORDER);
                        cell2_Two.setBorder(Rectangle.NO_BORDER);
                        cell2_Three.setBorder(Rectangle.NO_BORDER);

                        PdfPCell cell2_four = new PdfPCell(new Phrase("Tempat / Tanggal Lahir"));
                        PdfPCell cell2_five = new PdfPCell(new Phrase(":"));
                        PdfPCell cell2_six = new PdfPCell(new Phrase(sk.tempat+", "+Fungsi.getDate(sk.tgl_lahir)));

                        cell2_four.setBorder(Rectangle.NO_BORDER);
                        cell2_five.setBorder(Rectangle.NO_BORDER);
                        cell2_six.setBorder(Rectangle.NO_BORDER);

                        PdfPCell cell2_seven = new PdfPCell(new Phrase("NIS/NISN"));
                        PdfPCell cell2_eight = new PdfPCell(new Phrase(":"));
                        PdfPCell cell2_nine = new PdfPCell(new Phrase(sk.nipd+"/"+sk.nisn));

                        cell2_seven.setBorder(Rectangle.NO_BORDER);
                        cell2_eight.setBorder(Rectangle.NO_BORDER);
                        cell2_nine.setBorder(Rectangle.NO_BORDER);

                        PdfPCell cell2_ten = new PdfPCell(new Phrase("Sekolah"));
                        PdfPCell cell2_eleven = new PdfPCell(new Phrase(":"));
                        PdfPCell cell2_twelve = new PdfPCell(new Phrase("SMP Negeri 223 Jakarta"));

                        cell2_ten.setBorder(Rectangle.NO_BORDER);
                        cell2_eleven.setBorder(Rectangle.NO_BORDER);
                        cell2_twelve.setBorder(Rectangle.NO_BORDER);
                        cell2_twelve.setPaddingBottom(20f);

                        // Add table2 cells
                        table2.addCell(cell2_One);
                        table2.addCell(cell2_Two);
                        table2.addCell(cell2_Three);
                        table2.addCell(cell2_four);
                        table2.addCell(cell2_five);
                        table2.addCell(cell2_six);
                        table2.addCell(cell2_seven);
                        table2.addCell(cell2_eight);
                        table2.addCell(cell2_nine);
                        table2.addCell(cell2_ten);
                        table2.addCell(cell2_eleven);
                        table2.addCell(cell2_twelve);

                        document.add(table2);

                        Font boldFont = new Font(Font.FontFamily.HELVETICA, 11);
                        Paragraph para1 = new Paragraph(keterangan, boldFont);
                        para1.setAlignment(Element.ALIGN_JUSTIFIED);
                        para1.setFirstLineIndent(30f);
                        para1.setSpacingAfter(25f);

                        document.add(para1);

                        Paragraph para2 = new Paragraph("Demikian surat keterangan ini dibuat agar dapat dipergunakan sebagaimana mestinya.", boldFont);
                        para2.setAlignment(Element.ALIGN_JUSTIFIED);
                        para2.setFirstLineIndent(30f);
                        para2.setSpacingAfter(15f);

                        document.add(para2);

                        // Create the content table
                        PdfPTable contentTable3 = new PdfPTable(1);
                        contentTable3.setWidthPercentage(48);
                        contentTable3.setHorizontalAlignment(Element.ALIGN_RIGHT);

                        // Add the content rows to the table
                        PdfPCell cell_footer = new PdfPCell(new Phrase("Jakarta, "+Fungsi.getDate(dateChooser), new Font(Font.FontFamily.HELVETICA,11)));
                        cell_footer.setBorder(PdfPCell.NO_BORDER);                
                        contentTable3.addCell(cell_footer);

                        PdfPCell cell_footer2 = new PdfPCell(new Phrase("Kepala SMP Negeri 223 Jakarta", new Font(Font.FontFamily.HELVETICA,11)));
                        cell_footer2.setBorder(PdfPCell.NO_BORDER);  
                        cell_footer2.setPaddingBottom(60f);
                        contentTable3.addCell(cell_footer2);

                        // Add the content rows to the table
                        PdfPCell cell_footer3 = new PdfPCell(new Phrase("OMAN NURYANI, M.Pd.", new Font(Font.FontFamily.HELVETICA,11)));
                        cell_footer3.setBorder(PdfPCell.NO_BORDER);                
                        contentTable3.addCell(cell_footer3);

                        PdfPCell cell_footer4 = new PdfPCell(new Phrase("NIP. 196807191997031003", new Font(Font.FontFamily.HELVETICA,11)));
                        cell_footer4.setBorder(PdfPCell.NO_BORDER);  
                        contentTable3.addCell(cell_footer4);

                        document.add(contentTable3);

                        document.close();
                        System.out.println("File created successfully");
                    } else {
                        System.out.println("Failed to create file");
                    }
                } catch (IOException e) {
                    System.out.println(e);
                    System.out.println("An error occurred while creating the file: " + e.getMessage());
                }
            } else {
                //if file exist, then we can create the content from pdf
                //50 pertama itu left
                        //50 kedua itu right
                        Document document = new Document(PageSize.A4, 45, 45, 5, 50);
                        PdfWriter.getInstance(document, new FileOutputStream(filePath));

                        document.open();

                        // Create the header table
                        PdfPTable headerTable = new PdfPTable(2);
                        headerTable.setWidthPercentage(100);
                        headerTable.setWidths(new float[]{13, 87});

                        // Create the image cell
                        PdfPCell imageCell = new PdfPCell();
                        Image logo = Image.getInstance(getClass().getResource("/logo-jakarta-raya.jpeg"));
                        logo.scaleToFit(87, 125);
                        logo.setSpacingBefore(10f);
                        imageCell.addElement(logo);
                        imageCell.setRowspan(7);
                        imageCell.setBorder(PdfPCell.NO_BORDER);
                        headerTable.addCell(imageCell);

                        // Create the text cell
                        PdfPCell textCell = new PdfPCell();
                        Paragraph paragraph1 = new Paragraph("PEMERINTAH PROVINSI DAERAH KHUSUS IBUKOTA JAKARTA\nDINAS PENDIDIKAN", new Font(Font.FontFamily.HELVETICA, 11));
                        paragraph1.setAlignment(Paragraph.ALIGN_CENTER);
                        Paragraph paragraph2 = new Paragraph("SMP NEGERI 223 JAKARTA", new Font(Font.FontFamily.HELVETICA, 12, Font.BOLD));
                        paragraph2.setAlignment(Paragraph.ALIGN_CENTER);
                        Paragraph paragraph3 = new Paragraph("Jl. Surilang No. 6 Kel. Gedong Kec. Pasar Rebo\nTelepon (021) 8403316 Faximile (021) 8403316", new Font(Font.FontFamily.HELVETICA,11));
                        paragraph3.setAlignment(Paragraph.ALIGN_CENTER);
                        Paragraph paragraph4 = new Paragraph("E-mail: smpn223jktm@gmail.com\nJAKARTA", new Font(Font.FontFamily.HELVETICA, 11));
                        paragraph4.setAlignment(Paragraph.ALIGN_CENTER);
                        Paragraph paragraph5 = new Paragraph("Kode Pos : 13760", new Font(Font.FontFamily.HELVETICA, 11));
                        paragraph5.setAlignment(Paragraph.ALIGN_RIGHT);
                        Paragraph paragraph6 = new Paragraph(" ", new Font(Font.FontFamily.HELVETICA, 3));

                        textCell.addElement(paragraph1);
                        textCell.addElement(paragraph2);
                        textCell.addElement(paragraph3);
                        textCell.addElement(paragraph4);
                        textCell.addElement(paragraph5);
                        textCell.addElement(paragraph6);
                        textCell.setBorder(PdfPCell.NO_BORDER);
                        headerTable.addCell(textCell);

                        // Add the header table to the document
                        document.add(headerTable);

                        // Add a horizontal line
                        LineSeparator lineSeparator = new LineSeparator();
                        lineSeparator.setLineWidth(2);
                        document.add(lineSeparator);

                        // Create the content table
                        PdfPTable contentTable = new PdfPTable(1);
                        contentTable.setWidthPercentage(100);

                        // Add the content rows to the table
                        PdfPCell cell1 = new PdfPCell(new Phrase("SURAT KETERANGAN", new Font(Font.FontFamily.HELVETICA,15, Font.BOLD)));
                        cell1.setBorder(PdfPCell.NO_BORDER);
                        cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell1.setPaddingTop(20f);
                        cell1.setPaddingBottom(7f);
                        contentTable.addCell(cell1);

                        PdfPCell cell2 = new PdfPCell(new Phrase("NOMOR : "+no_surat, new Font(Font.FontFamily.HELVETICA,13)));
                        cell2.setBorder(PdfPCell.NO_BORDER);
                        cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
                        cell2.setPaddingBottom(35f);
                        contentTable.addCell(cell2);

                        PdfPCell cell3 = new PdfPCell(new Phrase("Yang bertanda tangan dibawah ini : ", new Font(Font.FontFamily.HELVETICA, 11)));
                        cell3.setBorder(PdfPCell.NO_BORDER);
                        cell3.setHorizontalAlignment(Element.ALIGN_LEFT);
                        cell3.setPaddingBottom(20f);
                        cell3.setPaddingLeft(30f);
                        contentTable.addCell(cell3);

                        // Add the content table to the document
                        document.add(contentTable);

                        PdfPTable table = new PdfPTable(3);

                        // Set table properties
                        table.setWidthPercentage(62);
                        table.setHorizontalAlignment(Element.ALIGN_LEFT);
                        float[] columnWidths = {1.7f, 0.1f, 2f};
                        table.setWidths(columnWidths);

                        PdfPCell cellOne = new PdfPCell(new Phrase("Nama"));
                        PdfPCell cellTwo = new PdfPCell(new Phrase(":"));
                        PdfPCell cellThree = new PdfPCell(new Phrase(bertanda_tangan));

                        cellOne.setBorder(Rectangle.NO_BORDER);
                        cellTwo.setBorder(Rectangle.NO_BORDER);
                        cellThree.setBorder(Rectangle.NO_BORDER);

                        PdfPCell cellFour = new PdfPCell(new Phrase("NIP / NRK"));
                        PdfPCell cellFive = new PdfPCell(new Phrase(":"));
                        PdfPCell cellSix = new PdfPCell(new Phrase(sk.nip+"/"+sk.nrk));

                        cellFour.setBorder(Rectangle.NO_BORDER);
                        cellFive.setBorder(Rectangle.NO_BORDER);
                        cellSix.setBorder(Rectangle.NO_BORDER);

                        PdfPCell cellSeven = new PdfPCell(new Phrase("Pangkat / Golongan"));
                        PdfPCell cellEight = new PdfPCell(new Phrase(":"));
                        PdfPCell cellNine = new PdfPCell(new Phrase(sk.pangkat+"/ ("+sk.golongan+")"));

                        cellSeven.setBorder(Rectangle.NO_BORDER);
                        cellEight.setBorder(Rectangle.NO_BORDER);
                        cellNine.setBorder(Rectangle.NO_BORDER);

                        PdfPCell cellTen = new PdfPCell(new Phrase("Jabatan"));
                        PdfPCell cellEleven = new PdfPCell(new Phrase(":"));
                        PdfPCell cellTwelve =  new PdfPCell(new Phrase(sk.jabatan));

                        cellTen.setBorder(Rectangle.NO_BORDER);
                        cellEleven.setBorder(Rectangle.NO_BORDER);
                        cellTwelve.setBorder(Rectangle.NO_BORDER);
                        cellTwelve.setPaddingBottom(20f);

                        // Add table cells
                        table.addCell(cellOne);
                        table.addCell(cellTwo);
                        table.addCell(cellThree);
                        table.addCell(cellFour);
                        table.addCell(cellFive);
                        table.addCell(cellSix);
                        table.addCell(cellSeven);
                        table.addCell(cellEight);
                        table.addCell(cellNine);
                        table.addCell(cellTen);
                        table.addCell(cellEleven);
                        table.addCell(cellTwelve);

                        // Add the table to the document
                        document.add(table);

                        // Create the content table
                        PdfPTable contentTable2 = new PdfPTable(1);
                        contentTable2.setWidthPercentage(100);

                        PdfPCell cell4 = new PdfPCell(new Phrase("menerangkan dengan sesungguhnya bahwa : ", new Font(Font.FontFamily.HELVETICA, 11)));
                        cell4.setBorder(PdfPCell.NO_BORDER);
                        cell4.setHorizontalAlignment(Element.ALIGN_LEFT);
                        cell4.setPaddingBottom(20f);
                        cell4.setPaddingLeft(30f);
                        contentTable2.addCell(cell4);

                        // Add the contentTable2 to the document
                        document.add(contentTable2);

                        PdfPTable table2 = new PdfPTable(3);

                        // Set table properties
                        table2.setWidthPercentage(62);
                        table2.setHorizontalAlignment(Element.ALIGN_LEFT);
                        float[] columnWidths2 = {1.7f, 0.1f, 2f};
                        table2.setWidths(columnWidths2);

                        PdfPCell cell2_One = new PdfPCell(new Phrase("Nama"));
                        PdfPCell cell2_Two = new PdfPCell(new Phrase(":"));
                        PdfPCell cell2_Three = new PdfPCell(new Phrase(menerangkan));

                        cell2_One.setBorder(Rectangle.NO_BORDER);
                        cell2_Two.setBorder(Rectangle.NO_BORDER);
                        cell2_Three.setBorder(Rectangle.NO_BORDER);

                        PdfPCell cell2_four = new PdfPCell(new Phrase("Tempat / Tanggal Lahir"));
                        PdfPCell cell2_five = new PdfPCell(new Phrase(":"));
                        PdfPCell cell2_six = new PdfPCell(new Phrase(sk.tempat+", "+Fungsi.getDate(sk.tgl_lahir)));

                        cell2_four.setBorder(Rectangle.NO_BORDER);
                        cell2_five.setBorder(Rectangle.NO_BORDER);
                        cell2_six.setBorder(Rectangle.NO_BORDER);

                        PdfPCell cell2_seven = new PdfPCell(new Phrase("NIS/NISN"));
                        PdfPCell cell2_eight = new PdfPCell(new Phrase(":"));
                        PdfPCell cell2_nine = new PdfPCell(new Phrase(sk.nipd+"/"+sk.nisn));

                        cell2_seven.setBorder(Rectangle.NO_BORDER);
                        cell2_eight.setBorder(Rectangle.NO_BORDER);
                        cell2_nine.setBorder(Rectangle.NO_BORDER);

                        PdfPCell cell2_ten = new PdfPCell(new Phrase("Sekolah"));
                        PdfPCell cell2_eleven = new PdfPCell(new Phrase(":"));
                        PdfPCell cell2_twelve = new PdfPCell(new Phrase("SMP Negeri 223 Jakarta"));

                        cell2_ten.setBorder(Rectangle.NO_BORDER);
                        cell2_eleven.setBorder(Rectangle.NO_BORDER);
                        cell2_twelve.setBorder(Rectangle.NO_BORDER);
                        cell2_twelve.setPaddingBottom(20f);

                        // Add table2 cells
                        table2.addCell(cell2_One);
                        table2.addCell(cell2_Two);
                        table2.addCell(cell2_Three);
                        table2.addCell(cell2_four);
                        table2.addCell(cell2_five);
                        table2.addCell(cell2_six);
                        table2.addCell(cell2_seven);
                        table2.addCell(cell2_eight);
                        table2.addCell(cell2_nine);
                        table2.addCell(cell2_ten);
                        table2.addCell(cell2_eleven);
                        table2.addCell(cell2_twelve);

                        document.add(table2);

                        Font boldFont = new Font(Font.FontFamily.HELVETICA, 11);
                        Paragraph para1 = new Paragraph(keterangan, boldFont);
                        para1.setAlignment(Element.ALIGN_JUSTIFIED);
                        para1.setFirstLineIndent(30f);
                        para1.setSpacingAfter(25f);

                        document.add(para1);

                        Paragraph para2 = new Paragraph("Demikian surat keterangan ini dibuat agar dapat dipergunakan sebagaimana mestinya.", boldFont);
                        para2.setAlignment(Element.ALIGN_JUSTIFIED);
                        para2.setFirstLineIndent(30f);
                        para2.setSpacingAfter(15f);

                        document.add(para2);

                        // Create the content table
                        PdfPTable contentTable3 = new PdfPTable(1);
                        contentTable3.setWidthPercentage(48);
                        contentTable3.setHorizontalAlignment(Element.ALIGN_RIGHT);

                        // Add the content rows to the table
                        PdfPCell cell_footer = new PdfPCell(new Phrase("Jakarta, "+Fungsi.getDate(dateChooser), new Font(Font.FontFamily.HELVETICA,11)));
                        cell_footer.setBorder(PdfPCell.NO_BORDER);                
                        contentTable3.addCell(cell_footer);

                        PdfPCell cell_footer2 = new PdfPCell(new Phrase("Kepala SMP Negeri 223 Jakarta", new Font(Font.FontFamily.HELVETICA,11)));
                        cell_footer2.setBorder(PdfPCell.NO_BORDER);  
                        cell_footer2.setPaddingBottom(60f);
                        contentTable3.addCell(cell_footer2);

                        // Add the content rows to the table
                        PdfPCell cell_footer3 = new PdfPCell(new Phrase("OMAN NURYANI, M.Pd.", new Font(Font.FontFamily.HELVETICA,11)));
                        cell_footer3.setBorder(PdfPCell.NO_BORDER);                
                        contentTable3.addCell(cell_footer3);

                        PdfPCell cell_footer4 = new PdfPCell(new Phrase("NIP. 196807191997031003", new Font(Font.FontFamily.HELVETICA,11)));
                        cell_footer4.setBorder(PdfPCell.NO_BORDER);  
                        contentTable3.addCell(cell_footer4);

                        document.add(contentTable3);

                document.close();
                System.out.println("File created successfully");
            }
            File file1 = new File(filePath);

            JOptionPane.showMessageDialog(null, "Data berhasil dicetak", "Pesan", JOptionPane.INFORMATION_MESSAGE);
            // Open the URL in the default web browser
            Desktop.getDesktop().open(file1);
        } catch (Exception e) {
            System.out.println(e);
        }
    }//GEN-LAST:event_jButton6ActionPerformed

    private void jButton6KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jButton6KeyPressed
        // TODO add your handling code here:
        if(evt.getKeyCode() == KeyEvent.VK_ENTER){
            Connection conn = Koneksi.getConnection();
            try {
                FSurat_Keterangan sk = new FSurat_Keterangan();
                String no_surat = jTextField3.getText();
                String bertanda_tangan = jComboBox1.getItemAt(jComboBox1.getSelectedIndex());
                String menerangkan = jComboBox2.getItemAt(jComboBox2.getSelectedIndex());
                sk.setBertandaTangan(bertanda_tangan);
                sk.setKepada(menerangkan);
                Object tgl_surat = jDateChooser1.getDate();
                String keterangan = jTextArea1.getText();
                String folderPath = "C:\\simpati223";
                String filePath = "C:\\simpati223\\surat_keterangan_"+menerangkan+".pdf";

                // Check if folder exists, create if it doesn't
                File folder = new File(folderPath);
                if (!folder.exists()) {
                    boolean created = folder.mkdirs();
                    if (created) {
                        System.out.println("Folder created successfully");
                    } else {
                        System.out.println("Failed to create folder");
                    }
                } else {
                    System.out.println("Folder already exists");
                }

                // Check if file exists, create if it doesn't
                File file = new File(filePath);
                if (!file.exists()) {
                    try {
                        boolean created = file.createNewFile();
                        if (created) {
                            //after created file, then we can create a content from pdf
                            //50 pertama itu left
                            //50 kedua itu right
                            Document document = new Document(PageSize.A4, 45, 45, 5, 50);
                            PdfWriter.getInstance(document, new FileOutputStream(filePath));

                            document.open();

                            // Create the header table
                            PdfPTable headerTable = new PdfPTable(2);
                            headerTable.setWidthPercentage(100);
                            headerTable.setWidths(new float[]{13, 87});

                            // Create the image cell
                            PdfPCell imageCell = new PdfPCell();
                            Image logo = Image.getInstance(getClass().getResource("/logo-jakarta-raya.jpeg"));
                            logo.scaleToFit(87, 125);
                            logo.setSpacingBefore(10f);
                            imageCell.addElement(logo);
                            imageCell.setRowspan(7);
                            imageCell.setBorder(PdfPCell.NO_BORDER);
                            headerTable.addCell(imageCell);

                            // Create the text cell
                            PdfPCell textCell = new PdfPCell();
                            Paragraph paragraph1 = new Paragraph("PEMERINTAH PROVINSI DAERAH KHUSUS IBUKOTA JAKARTA\nDINAS PENDIDIKAN", new Font(Font.FontFamily.HELVETICA, 11));
                            paragraph1.setAlignment(Paragraph.ALIGN_CENTER);
                            Paragraph paragraph2 = new Paragraph("SMP NEGERI 223 JAKARTA", new Font(Font.FontFamily.HELVETICA, 12, Font.BOLD));
                            paragraph2.setAlignment(Paragraph.ALIGN_CENTER);
                            Paragraph paragraph3 = new Paragraph("Jl. Surilang No. 6 Kel. Gedong Kec. Pasar Rebo\nTelepon (021) 8403316 Faximile (021) 8403316", new Font(Font.FontFamily.HELVETICA,11));
                            paragraph3.setAlignment(Paragraph.ALIGN_CENTER);
                            Paragraph paragraph4 = new Paragraph("E-mail: smpn223jktm@gmail.com\nJAKARTA", new Font(Font.FontFamily.HELVETICA, 11));
                            paragraph4.setAlignment(Paragraph.ALIGN_CENTER);
                            Paragraph paragraph5 = new Paragraph("Kode Pos : 13760", new Font(Font.FontFamily.HELVETICA, 11));
                            paragraph5.setAlignment(Paragraph.ALIGN_RIGHT);
                            Paragraph paragraph6 = new Paragraph(" ", new Font(Font.FontFamily.HELVETICA, 3));

                            textCell.addElement(paragraph1);
                            textCell.addElement(paragraph2);
                            textCell.addElement(paragraph3);
                            textCell.addElement(paragraph4);
                            textCell.addElement(paragraph5);
                            textCell.addElement(paragraph6);
                            textCell.setBorder(PdfPCell.NO_BORDER);
                            headerTable.addCell(textCell);

                            // Add the header table to the document
                            document.add(headerTable);

                            // Add a horizontal line
                            LineSeparator lineSeparator = new LineSeparator();
                            lineSeparator.setLineWidth(2);
                            document.add(lineSeparator);

                            // Create the content table
                            PdfPTable contentTable = new PdfPTable(1);
                            contentTable.setWidthPercentage(100);

                            // Add the content rows to the table
                            PdfPCell cell1 = new PdfPCell(new Phrase("SURAT KETERANGAN", new Font(Font.FontFamily.HELVETICA,15, Font.BOLD)));
                            cell1.setBorder(PdfPCell.NO_BORDER);
                            cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell1.setPaddingTop(20f);
                            cell1.setPaddingBottom(7f);
                            contentTable.addCell(cell1);

                            PdfPCell cell2 = new PdfPCell(new Phrase("NOMOR : "+no_surat, new Font(Font.FontFamily.HELVETICA,13)));
                            cell2.setBorder(PdfPCell.NO_BORDER);
                            cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell2.setPaddingBottom(35f);
                            contentTable.addCell(cell2);

                            PdfPCell cell3 = new PdfPCell(new Phrase("Yang bertanda tangan dibawah ini : ", new Font(Font.FontFamily.HELVETICA, 11)));
                            cell3.setBorder(PdfPCell.NO_BORDER);
                            cell3.setHorizontalAlignment(Element.ALIGN_LEFT);
                            cell3.setPaddingBottom(20f);
                            cell3.setPaddingLeft(30f);
                            contentTable.addCell(cell3);

                            // Add the content table to the document
                            document.add(contentTable);

                            PdfPTable table = new PdfPTable(3);

                            // Set table properties
                            table.setWidthPercentage(62);
                            table.setHorizontalAlignment(Element.ALIGN_LEFT);
                            float[] columnWidths = {1.7f, 0.1f, 2f};
                            table.setWidths(columnWidths);

                            PdfPCell cellOne = new PdfPCell(new Phrase("Nama"));
                            PdfPCell cellTwo = new PdfPCell(new Phrase(":"));
                            PdfPCell cellThree = new PdfPCell(new Phrase(bertanda_tangan));

                            cellOne.setBorder(Rectangle.NO_BORDER);
                            cellTwo.setBorder(Rectangle.NO_BORDER);
                            cellThree.setBorder(Rectangle.NO_BORDER);

                            PdfPCell cellFour = new PdfPCell(new Phrase("NIP / NRK"));
                            PdfPCell cellFive = new PdfPCell(new Phrase(":"));
                            PdfPCell cellSix = new PdfPCell(new Phrase(sk.nip+"/"+sk.nrk));

                            cellFour.setBorder(Rectangle.NO_BORDER);
                            cellFive.setBorder(Rectangle.NO_BORDER);
                            cellSix.setBorder(Rectangle.NO_BORDER);

                            PdfPCell cellSeven = new PdfPCell(new Phrase("Pangkat / Golongan"));
                            PdfPCell cellEight = new PdfPCell(new Phrase(":"));
                            PdfPCell cellNine = new PdfPCell(new Phrase(sk.pangkat+"/ ("+sk.golongan+")"));

                            cellSeven.setBorder(Rectangle.NO_BORDER);
                            cellEight.setBorder(Rectangle.NO_BORDER);
                            cellNine.setBorder(Rectangle.NO_BORDER);

                            PdfPCell cellTen = new PdfPCell(new Phrase("Jabatan"));
                            PdfPCell cellEleven = new PdfPCell(new Phrase(":"));
                            PdfPCell cellTwelve =  new PdfPCell(new Phrase(sk.jabatan));

                            cellTen.setBorder(Rectangle.NO_BORDER);
                            cellEleven.setBorder(Rectangle.NO_BORDER);
                            cellTwelve.setBorder(Rectangle.NO_BORDER);
                            cellTwelve.setPaddingBottom(20f);

                            // Add table cells
                            table.addCell(cellOne);
                            table.addCell(cellTwo);
                            table.addCell(cellThree);
                            table.addCell(cellFour);
                            table.addCell(cellFive);
                            table.addCell(cellSix);
                            table.addCell(cellSeven);
                            table.addCell(cellEight);
                            table.addCell(cellNine);
                            table.addCell(cellTen);
                            table.addCell(cellEleven);
                            table.addCell(cellTwelve);

                            // Add the table to the document
                            document.add(table);

                            // Create the content table
                            PdfPTable contentTable2 = new PdfPTable(1);
                            contentTable2.setWidthPercentage(100);

                            PdfPCell cell4 = new PdfPCell(new Phrase("menerangkan dengan sesungguhnya bahwa : ", new Font(Font.FontFamily.HELVETICA, 11)));
                            cell4.setBorder(PdfPCell.NO_BORDER);
                            cell4.setHorizontalAlignment(Element.ALIGN_LEFT);
                            cell4.setPaddingBottom(20f);
                            cell4.setPaddingLeft(30f);
                            contentTable2.addCell(cell4);

                            // Add the contentTable2 to the document
                            document.add(contentTable2);

                            PdfPTable table2 = new PdfPTable(3);

                            // Set table properties
                            table2.setWidthPercentage(62);
                            table2.setHorizontalAlignment(Element.ALIGN_LEFT);
                            float[] columnWidths2 = {1.7f, 0.1f, 2f};
                            table2.setWidths(columnWidths2);

                            PdfPCell cell2_One = new PdfPCell(new Phrase("Nama"));
                            PdfPCell cell2_Two = new PdfPCell(new Phrase(":"));
                            PdfPCell cell2_Three = new PdfPCell(new Phrase(menerangkan));

                            cell2_One.setBorder(Rectangle.NO_BORDER);
                            cell2_Two.setBorder(Rectangle.NO_BORDER);
                            cell2_Three.setBorder(Rectangle.NO_BORDER);

                            PdfPCell cell2_four = new PdfPCell(new Phrase("Tempat / Tanggal Lahir"));
                            PdfPCell cell2_five = new PdfPCell(new Phrase(":"));
                            PdfPCell cell2_six = new PdfPCell(new Phrase(sk.tempat+", "+Fungsi.getDate(sk.tgl_lahir)));

                            cell2_four.setBorder(Rectangle.NO_BORDER);
                            cell2_five.setBorder(Rectangle.NO_BORDER);
                            cell2_six.setBorder(Rectangle.NO_BORDER);

                            PdfPCell cell2_seven = new PdfPCell(new Phrase("NIS/NISN"));
                            PdfPCell cell2_eight = new PdfPCell(new Phrase(":"));
                            PdfPCell cell2_nine = new PdfPCell(new Phrase(sk.nipd+"/"+sk.nisn));

                            cell2_seven.setBorder(Rectangle.NO_BORDER);
                            cell2_eight.setBorder(Rectangle.NO_BORDER);
                            cell2_nine.setBorder(Rectangle.NO_BORDER);

                            PdfPCell cell2_ten = new PdfPCell(new Phrase("Sekolah"));
                            PdfPCell cell2_eleven = new PdfPCell(new Phrase(":"));
                            PdfPCell cell2_twelve = new PdfPCell(new Phrase("SMP Negeri 223 Jakarta"));

                            cell2_ten.setBorder(Rectangle.NO_BORDER);
                            cell2_eleven.setBorder(Rectangle.NO_BORDER);
                            cell2_twelve.setBorder(Rectangle.NO_BORDER);
                            cell2_twelve.setPaddingBottom(20f);

                            // Add table2 cells
                            table2.addCell(cell2_One);
                            table2.addCell(cell2_Two);
                            table2.addCell(cell2_Three);
                            table2.addCell(cell2_four);
                            table2.addCell(cell2_five);
                            table2.addCell(cell2_six);
                            table2.addCell(cell2_seven);
                            table2.addCell(cell2_eight);
                            table2.addCell(cell2_nine);
                            table2.addCell(cell2_ten);
                            table2.addCell(cell2_eleven);
                            table2.addCell(cell2_twelve);

                            document.add(table2);

                            Font boldFont = new Font(Font.FontFamily.HELVETICA, 11);
                            Paragraph para1 = new Paragraph(keterangan, boldFont);
                            para1.setAlignment(Element.ALIGN_JUSTIFIED);
                            para1.setFirstLineIndent(30f);
                            para1.setSpacingAfter(25f);

                            document.add(para1);

                            Paragraph para2 = new Paragraph("Demikian surat keterangan ini dibuat agar dapat dipergunakan sebagaimana mestinya.", boldFont);
                            para2.setAlignment(Element.ALIGN_JUSTIFIED);
                            para2.setFirstLineIndent(30f);
                            para2.setSpacingAfter(15f);

                            document.add(para2);

                            // Create the content table
                            PdfPTable contentTable3 = new PdfPTable(1);
                            contentTable3.setWidthPercentage(48);
                            contentTable3.setHorizontalAlignment(Element.ALIGN_RIGHT);

                            // Add the content rows to the table
                            PdfPCell cell_footer = new PdfPCell(new Phrase("Jakarta, "+Fungsi.getDate(dateChooser), new Font(Font.FontFamily.HELVETICA,11)));
                            cell_footer.setBorder(PdfPCell.NO_BORDER);                
                            contentTable3.addCell(cell_footer);

                            PdfPCell cell_footer2 = new PdfPCell(new Phrase("Kepala SMP Negeri 223 Jakarta", new Font(Font.FontFamily.HELVETICA,11)));
                            cell_footer2.setBorder(PdfPCell.NO_BORDER);  
                            cell_footer2.setPaddingBottom(60f);
                            contentTable3.addCell(cell_footer2);

                            // Add the content rows to the table
                            PdfPCell cell_footer3 = new PdfPCell(new Phrase("OMAN NURYANI, M.Pd.", new Font(Font.FontFamily.HELVETICA,11)));
                            cell_footer3.setBorder(PdfPCell.NO_BORDER);                
                            contentTable3.addCell(cell_footer3);

                            PdfPCell cell_footer4 = new PdfPCell(new Phrase("NIP. 196807191997031003", new Font(Font.FontFamily.HELVETICA,11)));
                            cell_footer4.setBorder(PdfPCell.NO_BORDER);  
                            contentTable3.addCell(cell_footer4);

                            document.add(contentTable3);

                            document.close();
                            System.out.println("File created successfully");
                        } else {
                            System.out.println("Failed to create file");
                        }
                    } catch (IOException e) {
                        System.out.println(e);
                        System.out.println("An error occurred while creating the file: " + e.getMessage());
                    }
                } else {
                    //if file exist, then we can create the content from pdf
                    //50 pertama itu left
                            //50 kedua itu right
                            Document document = new Document(PageSize.A4, 45, 45, 5, 50);
                            PdfWriter.getInstance(document, new FileOutputStream(filePath));

                            document.open();

                            // Create the header table
                            PdfPTable headerTable = new PdfPTable(2);
                            headerTable.setWidthPercentage(100);
                            headerTable.setWidths(new float[]{13, 87});

                            // Create the image cell
                            PdfPCell imageCell = new PdfPCell();
                            Image logo = Image.getInstance(getClass().getResource("/logo-jakarta-raya.jpeg"));
                            logo.scaleToFit(87, 125);
                            logo.setSpacingBefore(10f);
                            imageCell.addElement(logo);
                            imageCell.setRowspan(7);
                            imageCell.setBorder(PdfPCell.NO_BORDER);
                            headerTable.addCell(imageCell);

                            // Create the text cell
                            PdfPCell textCell = new PdfPCell();
                            Paragraph paragraph1 = new Paragraph("PEMERINTAH PROVINSI DAERAH KHUSUS IBUKOTA JAKARTA\nDINAS PENDIDIKAN", new Font(Font.FontFamily.HELVETICA, 11));
                            paragraph1.setAlignment(Paragraph.ALIGN_CENTER);
                            Paragraph paragraph2 = new Paragraph("SMP NEGERI 223 JAKARTA", new Font(Font.FontFamily.HELVETICA, 12, Font.BOLD));
                            paragraph2.setAlignment(Paragraph.ALIGN_CENTER);
                            Paragraph paragraph3 = new Paragraph("Jl. Surilang No. 6 Kel. Gedong Kec. Pasar Rebo\nTelepon (021) 8403316 Faximile (021) 8403316", new Font(Font.FontFamily.HELVETICA,11));
                            paragraph3.setAlignment(Paragraph.ALIGN_CENTER);
                            Paragraph paragraph4 = new Paragraph("E-mail: smpn223jktm@gmail.com\nJAKARTA", new Font(Font.FontFamily.HELVETICA, 11));
                            paragraph4.setAlignment(Paragraph.ALIGN_CENTER);
                            Paragraph paragraph5 = new Paragraph("Kode Pos : 13760", new Font(Font.FontFamily.HELVETICA, 11));
                            paragraph5.setAlignment(Paragraph.ALIGN_RIGHT);
                            Paragraph paragraph6 = new Paragraph(" ", new Font(Font.FontFamily.HELVETICA, 3));

                            textCell.addElement(paragraph1);
                            textCell.addElement(paragraph2);
                            textCell.addElement(paragraph3);
                            textCell.addElement(paragraph4);
                            textCell.addElement(paragraph5);
                            textCell.addElement(paragraph6);
                            textCell.setBorder(PdfPCell.NO_BORDER);
                            headerTable.addCell(textCell);

                            // Add the header table to the document
                            document.add(headerTable);

                            // Add a horizontal line
                            LineSeparator lineSeparator = new LineSeparator();
                            lineSeparator.setLineWidth(2);
                            document.add(lineSeparator);

                            // Create the content table
                            PdfPTable contentTable = new PdfPTable(1);
                            contentTable.setWidthPercentage(100);

                            // Add the content rows to the table
                            PdfPCell cell1 = new PdfPCell(new Phrase("SURAT KETERANGAN", new Font(Font.FontFamily.HELVETICA,15, Font.BOLD)));
                            cell1.setBorder(PdfPCell.NO_BORDER);
                            cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell1.setPaddingTop(20f);
                            cell1.setPaddingBottom(7f);
                            contentTable.addCell(cell1);

                            PdfPCell cell2 = new PdfPCell(new Phrase("NOMOR : "+no_surat, new Font(Font.FontFamily.HELVETICA,13)));
                            cell2.setBorder(PdfPCell.NO_BORDER);
                            cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
                            cell2.setPaddingBottom(35f);
                            contentTable.addCell(cell2);

                            PdfPCell cell3 = new PdfPCell(new Phrase("Yang bertanda tangan dibawah ini : ", new Font(Font.FontFamily.HELVETICA, 11)));
                            cell3.setBorder(PdfPCell.NO_BORDER);
                            cell3.setHorizontalAlignment(Element.ALIGN_LEFT);
                            cell3.setPaddingBottom(20f);
                            cell3.setPaddingLeft(30f);
                            contentTable.addCell(cell3);

                            // Add the content table to the document
                            document.add(contentTable);

                            PdfPTable table = new PdfPTable(3);

                            // Set table properties
                            table.setWidthPercentage(62);
                            table.setHorizontalAlignment(Element.ALIGN_LEFT);
                            float[] columnWidths = {1.7f, 0.1f, 2f};
                            table.setWidths(columnWidths);

                            PdfPCell cellOne = new PdfPCell(new Phrase("Nama"));
                            PdfPCell cellTwo = new PdfPCell(new Phrase(":"));
                            PdfPCell cellThree = new PdfPCell(new Phrase(bertanda_tangan));

                            cellOne.setBorder(Rectangle.NO_BORDER);
                            cellTwo.setBorder(Rectangle.NO_BORDER);
                            cellThree.setBorder(Rectangle.NO_BORDER);

                            PdfPCell cellFour = new PdfPCell(new Phrase("NIP / NRK"));
                            PdfPCell cellFive = new PdfPCell(new Phrase(":"));
                            PdfPCell cellSix = new PdfPCell(new Phrase(sk.nip+"/"+sk.nrk));

                            cellFour.setBorder(Rectangle.NO_BORDER);
                            cellFive.setBorder(Rectangle.NO_BORDER);
                            cellSix.setBorder(Rectangle.NO_BORDER);

                            PdfPCell cellSeven = new PdfPCell(new Phrase("Pangkat / Golongan"));
                            PdfPCell cellEight = new PdfPCell(new Phrase(":"));
                            PdfPCell cellNine = new PdfPCell(new Phrase(sk.pangkat+"/ ("+sk.golongan+")"));

                            cellSeven.setBorder(Rectangle.NO_BORDER);
                            cellEight.setBorder(Rectangle.NO_BORDER);
                            cellNine.setBorder(Rectangle.NO_BORDER);

                            PdfPCell cellTen = new PdfPCell(new Phrase("Jabatan"));
                            PdfPCell cellEleven = new PdfPCell(new Phrase(":"));
                            PdfPCell cellTwelve =  new PdfPCell(new Phrase(sk.jabatan));

                            cellTen.setBorder(Rectangle.NO_BORDER);
                            cellEleven.setBorder(Rectangle.NO_BORDER);
                            cellTwelve.setBorder(Rectangle.NO_BORDER);
                            cellTwelve.setPaddingBottom(20f);

                            // Add table cells
                            table.addCell(cellOne);
                            table.addCell(cellTwo);
                            table.addCell(cellThree);
                            table.addCell(cellFour);
                            table.addCell(cellFive);
                            table.addCell(cellSix);
                            table.addCell(cellSeven);
                            table.addCell(cellEight);
                            table.addCell(cellNine);
                            table.addCell(cellTen);
                            table.addCell(cellEleven);
                            table.addCell(cellTwelve);

                            // Add the table to the document
                            document.add(table);

                            // Create the content table
                            PdfPTable contentTable2 = new PdfPTable(1);
                            contentTable2.setWidthPercentage(100);

                            PdfPCell cell4 = new PdfPCell(new Phrase("menerangkan dengan sesungguhnya bahwa : ", new Font(Font.FontFamily.HELVETICA, 11)));
                            cell4.setBorder(PdfPCell.NO_BORDER);
                            cell4.setHorizontalAlignment(Element.ALIGN_LEFT);
                            cell4.setPaddingBottom(20f);
                            cell4.setPaddingLeft(30f);
                            contentTable2.addCell(cell4);

                            // Add the contentTable2 to the document
                            document.add(contentTable2);

                            PdfPTable table2 = new PdfPTable(3);

                            // Set table properties
                            table2.setWidthPercentage(62);
                            table2.setHorizontalAlignment(Element.ALIGN_LEFT);
                            float[] columnWidths2 = {1.7f, 0.1f, 2f};
                            table2.setWidths(columnWidths2);

                            PdfPCell cell2_One = new PdfPCell(new Phrase("Nama"));
                            PdfPCell cell2_Two = new PdfPCell(new Phrase(":"));
                            PdfPCell cell2_Three = new PdfPCell(new Phrase(menerangkan));

                            cell2_One.setBorder(Rectangle.NO_BORDER);
                            cell2_Two.setBorder(Rectangle.NO_BORDER);
                            cell2_Three.setBorder(Rectangle.NO_BORDER);

                            PdfPCell cell2_four = new PdfPCell(new Phrase("Tempat / Tanggal Lahir"));
                            PdfPCell cell2_five = new PdfPCell(new Phrase(":"));
                            PdfPCell cell2_six = new PdfPCell(new Phrase(sk.tempat+", "+Fungsi.getDate(sk.tgl_lahir)));

                            cell2_four.setBorder(Rectangle.NO_BORDER);
                            cell2_five.setBorder(Rectangle.NO_BORDER);
                            cell2_six.setBorder(Rectangle.NO_BORDER);

                            PdfPCell cell2_seven = new PdfPCell(new Phrase("NIS/NISN"));
                            PdfPCell cell2_eight = new PdfPCell(new Phrase(":"));
                            PdfPCell cell2_nine = new PdfPCell(new Phrase(sk.nipd+"/"+sk.nisn));

                            cell2_seven.setBorder(Rectangle.NO_BORDER);
                            cell2_eight.setBorder(Rectangle.NO_BORDER);
                            cell2_nine.setBorder(Rectangle.NO_BORDER);

                            PdfPCell cell2_ten = new PdfPCell(new Phrase("Sekolah"));
                            PdfPCell cell2_eleven = new PdfPCell(new Phrase(":"));
                            PdfPCell cell2_twelve = new PdfPCell(new Phrase("SMP Negeri 223 Jakarta"));

                            cell2_ten.setBorder(Rectangle.NO_BORDER);
                            cell2_eleven.setBorder(Rectangle.NO_BORDER);
                            cell2_twelve.setBorder(Rectangle.NO_BORDER);
                            cell2_twelve.setPaddingBottom(20f);

                            // Add table2 cells
                            table2.addCell(cell2_One);
                            table2.addCell(cell2_Two);
                            table2.addCell(cell2_Three);
                            table2.addCell(cell2_four);
                            table2.addCell(cell2_five);
                            table2.addCell(cell2_six);
                            table2.addCell(cell2_seven);
                            table2.addCell(cell2_eight);
                            table2.addCell(cell2_nine);
                            table2.addCell(cell2_ten);
                            table2.addCell(cell2_eleven);
                            table2.addCell(cell2_twelve);

                            document.add(table2);

                            Font boldFont = new Font(Font.FontFamily.HELVETICA, 11);
                            Paragraph para1 = new Paragraph(keterangan, boldFont);
                            para1.setAlignment(Element.ALIGN_JUSTIFIED);
                            para1.setFirstLineIndent(30f);
                            para1.setSpacingAfter(25f);

                            document.add(para1);

                            Paragraph para2 = new Paragraph("Demikian surat keterangan ini dibuat agar dapat dipergunakan sebagaimana mestinya.", boldFont);
                            para2.setAlignment(Element.ALIGN_JUSTIFIED);
                            para2.setFirstLineIndent(30f);
                            para2.setSpacingAfter(15f);

                            document.add(para2);

                            // Create the content table
                            PdfPTable contentTable3 = new PdfPTable(1);
                            contentTable3.setWidthPercentage(48);
                            contentTable3.setHorizontalAlignment(Element.ALIGN_RIGHT);

                            // Add the content rows to the table
                            PdfPCell cell_footer = new PdfPCell(new Phrase("Jakarta, "+Fungsi.getDate(dateChooser), new Font(Font.FontFamily.HELVETICA,11)));
                            cell_footer.setBorder(PdfPCell.NO_BORDER);                
                            contentTable3.addCell(cell_footer);

                            PdfPCell cell_footer2 = new PdfPCell(new Phrase("Kepala SMP Negeri 223 Jakarta", new Font(Font.FontFamily.HELVETICA,11)));
                            cell_footer2.setBorder(PdfPCell.NO_BORDER);  
                            cell_footer2.setPaddingBottom(60f);
                            contentTable3.addCell(cell_footer2);

                            // Add the content rows to the table
                            PdfPCell cell_footer3 = new PdfPCell(new Phrase("OMAN NURYANI, M.Pd.", new Font(Font.FontFamily.HELVETICA,11)));
                            cell_footer3.setBorder(PdfPCell.NO_BORDER);                
                            contentTable3.addCell(cell_footer3);

                            PdfPCell cell_footer4 = new PdfPCell(new Phrase("NIP. 196807191997031003", new Font(Font.FontFamily.HELVETICA,11)));
                            cell_footer4.setBorder(PdfPCell.NO_BORDER);  
                            contentTable3.addCell(cell_footer4);

                            document.add(contentTable3);

                    document.close();
                    System.out.println("File created successfully");
                }
            } catch (Exception e) {
                System.out.println(e);
            }
        }
    }//GEN-LAST:event_jButton6KeyPressed


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton jButton1;
    private javax.swing.JButton jButton2;
    private javax.swing.JButton jButton3;
    private javax.swing.JButton jButton4;
    private javax.swing.JButton jButton5;
    private javax.swing.JButton jButton6;
    private javax.swing.JComboBox<String> jComboBox1;
    private javax.swing.JComboBox<String> jComboBox2;
    private com.toedter.calendar.JDateChooser jDateChooser1;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel10;
    private javax.swing.JLabel jLabel12;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel7;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JTable jTable1;
    private javax.swing.JTextArea jTextArea1;
    private javax.swing.JTextField jTextField2;
    private javax.swing.JTextField jTextField3;
    // End of variables declaration//GEN-END:variables
}
